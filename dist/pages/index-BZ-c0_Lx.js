import{D as m,r as T,k as e,K as E}from"../chunks/vendor-BASRo5BV.js";import{f as h}from"../assets/index-BGypb0Zl.js";import{T as f}from"../chunks/index-D0EwFrhZ.js";import{g as y,A as C,W as s,l as j,R as b,a as d,f as I,P as w,S as D,i as P,m as B,B as N}from"../chunks/ui-CrIkMfD8.js";import{I as g}from"../chunks/index-CNAIOIDt.js";import{W as S}from"../chunks/map-BPCwAIgA.js";import{b as F,u as q}from"../chunks/hooks-Dww1omTl.js";import{h as v,j as k,f as U}from"../chunks/wizard-CgjGpvtt.js";import"../chunks/utils-BMDVF5td.js";import"../chunks/index-CTOi45Ex.js";import"../chunks/enum-Ct7sVdAK.js";import"../chunks/generate-BFVzGyhc.js";const M=a=>{if(!a)return;const{elements:n,...l}=a;return{...l}},R=a=>({...a,updatedBy:"Admin"}),A=a=>{const{formData:n}=a,[l]=y.useForm(),{message:i}=C.useApp(),[o]=F(),c=m(()=>{l.setFieldsValue(M(n))});return T.useEffect(()=>{n&&c()},[n]),q(async()=>{var u;const r=await l.validateFields(),t=R(r);try{await v(t),o(),(u=a.onSuccess)==null||u.call(a),i.success(`Element ${n?"updated":"created"} successfully.`)}catch{i.error(`Failed to ${n?"update":"create"} Element.`)}}),e.jsxs(y,{form:l,submitter:!1,style:{padding:"24px 0 0 0"},children:[e.jsx(s,{hidden:!0,name:"elementUuid"}),e.jsx(s,{label:"Element Title",name:"elementTitle",rules:[{required:!0}]}),e.jsx(s,{label:"Data Type",name:"dataType",rules:[{required:!0}]}),e.jsx(s,{label:"Attribute Name",name:"attributeName",rules:[{required:!0}]}),e.jsx(s,{label:"Attribute Type",name:"attributeType",rules:[{required:!0}]}),e.jsx(s,{label:"Priority",name:"priority",rules:[{required:!0}]}),e.jsx(j,{label:"Option Values",name:"optionValues",creatorButtonProps:{creatorButtonText:"Add Option"},children:e.jsxs(b,{gutter:16,children:[e.jsx(d,{span:12,children:e.jsx(s,{name:"name",label:"Name",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})}),e.jsx(d,{span:12,children:e.jsx(s,{name:"value",label:"Value",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})})]})}),e.jsx(j,{label:"Conditions",name:"conditions",creatorButtonProps:{creatorButtonText:"Add Condition"},children:e.jsxs(b,{gutter:16,children:[e.jsx(d,{span:12,children:e.jsx(s,{name:"attribute",label:"Attribute",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})}),e.jsx(d,{span:12,children:e.jsx(s,{name:"value",label:"Value",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})})]})})]})},X=()=>{const{modal:a,message:n}=C.useApp(),l=E(),i=T.useRef(null),o=m(()=>{var r;(r=i.current)==null||r.reload()}),c=m(r=>{a.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify gray"},onOk:async()=>{try{await k({elementUuid:r.elementUuid}),o(),n.success("Deletion successful.")}catch(t){return n.error("Deletion failed."),Promise.reject(t)}}})});return e.jsx(I,{title:"UI Blocks / Elements",onBack:()=>l(-1),extra:e.jsx(f,{width:600,className:"shopify",title:"Create new element",trigger:e.jsx(N,{className:"shopify",type:"primary",children:"Create new element"}),children:e.jsx(A,{})}),children:e.jsx(w,{actionRef:i,search:!1,options:!1,scroll:{x:"max-content"},rowKey:"elementUuid",className:"shopify",request:async r=>{const{current:t,pageSize:u,...p}=r,{elementList:x}=await U({limit:u,pageNumber:t,...p});return{total:x.total,data:x.elementList}},columns:[{title:"Element Name",dataIndex:"elementTitle"},{title:"Element UUID",dataIndex:"elementUuid",hideInSearch:!0},{title:"Data Type",dataIndex:"dataType",valueEnum:S},{hideInSearch:!0,title:"Priority",dataIndex:"priority"},{title:"Create at",dataIndex:"createdAt",hideInSearch:!0,render:(r,t)=>h(t.createdAt)},{title:"Last updated",dataIndex:"updatedAt",hideInSearch:!0,render:(r,t)=>h(t.updatedAt)},{width:"120px",key:"action",title:"Action",align:"center",fixed:"right",hideInSearch:!0,render:(r,t)=>e.jsxs(D,{children:[e.jsx(f,{width:600,destroyOnHidden:!0,className:"shopify",title:"Element Details",trigger:e.jsx(g,{icon:P}),children:e.jsx(A,{formData:t,onSuccess:o})}),e.jsx(g,{icon:B,onClick:()=>c(t)})]})}]})})};export{X as default};
