import{k as o,r as h,D as l}from"../chunks/vendor-BASRo5BV.js";import{f as u}from"../assets/index-a3n_qMTh.js";import{T as m}from"../chunks/index-BSDmC2OP.js";import{g as p,A as y,W as f,k as C,h as j,f as A,P as D,S as N,i as P,m as F,B as S}from"../chunks/ui-CrIkMfD8.js";import{I as g}from"../chunks/index-CNAIOIDt.js";import{j as k}from"../chunks/useFetchData-D4J-x63P.js";import{b as w,u as I}from"../chunks/hooks-CKqr3Hp3.js";import{i as T,d as U,g as _}from"../chunks/contactProfiles-lR3wUpIb.js";import"../chunks/utils-BMDVF5td.js";import"../chunks/index-B4mFbccR.js";import"../chunks/workflow-Ceki6VW7.js";import"../chunks/generate-BNkr4RNj.js";import"../chunks/wizard-BPNZXcgu.js";import"../chunks/enum-Ct7sVdAK.js";const b=a=>{if(!a)return;const{agents:i=[],...r}=a;return{...r,agents:i.map(n=>n.agent_uuid)}},v=(a,i)=>{const{agents:r=[],...n}=a,s=r.map(t=>{var d;const e=(d=i.find(c=>c.value===t))==null?void 0:d.realData;return{agent_uuid:t,agent_type:"task",agent_name:e==null?void 0:e.agentName,agent_description:e==null?void 0:e.agentDescription}});return{...n,agents:s,updatedBy:"Admin"}},x=a=>{const{formData:i}=a,[r]=p.useForm(),{message:n}=y.useApp(),[s]=w(),t=k();return I(async()=>{var d;const e=await r.validateFields();try{const c=v(e,t.options);await T(c),n.success("Coordination created successfully."),s(),(d=a.onSuccess)==null||d.call(a)}catch{n.error("Failed to create Coordination.")}}),o.jsxs(p,{form:r,submitter:!1,style:{padding:"24px 0 0 0"},initialValues:b(i),children:[o.jsx(f,{name:"coordinationUuid",hidden:!0}),o.jsx(f,{required:!1,label:"Coordination Name",name:"coordinationName",rules:[{required:!0}]}),o.jsx(C,{required:!1,label:"Coordination Description",name:"coordinationDescription",rules:[{required:!0}]}),o.jsx(j,{label:"Connected agents",name:"agents",mode:"multiple",options:t.options,fieldProps:{maxTagCount:1,loading:t.loading}})]})},Q=()=>{const{modal:a,message:i}=y.useApp(),r=h.useRef(null),n=l(()=>{var t;(t=r.current)==null||t.reload()}),s=l(t=>{a.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify gray"},onOk:async()=>{try{await U({coordinationUuid:t.coordinationUuid}),n(),i.success("Deletion successful.")}catch(e){return i.error("Deletion failed."),Promise.reject(e)}}})});return o.jsx(A,{className:"shopify",title:"Coordinations",extra:o.jsx(m,{width:620,destroyOnHidden:!0,className:"shopify",title:"Add Coordination",trigger:o.jsx(S,{className:"shopify",type:"primary",children:"Add coordination"}),children:o.jsx(x,{onSuccess:n})}),children:o.jsx(D,{actionRef:r,className:"shopify",options:!1,size:"small",search:!1,pagination:{defaultPageSize:4},rowKey:"coordinationUuid",scroll:{x:"max-content"},columns:[{title:"Coordination UUID",dataIndex:"coordinationUuid"},{title:"Coordination Name",dataIndex:"coordinationName"},{title:"Create at",dataIndex:"createAt",render:(t,e)=>u(e.createAt)},{title:"Update at",dataIndex:"updateAt",render:(t,e)=>u(e.updateAt)},{width:100,title:"Actions",key:"action",fixed:"right",render:(t,e)=>o.jsxs(N,{children:[o.jsx(m,{width:620,destroyOnHidden:!0,className:"shopify",title:"Edit Coordination",trigger:o.jsx(g,{icon:P}),children:o.jsx(x,{formData:e,onSuccess:n})}),o.jsx(g,{icon:F,onClick:()=>s(e)})]})}],request:async t=>{const{coordinationList:e}=await _({limit:t.pageSize,pageNumber:t.current});return{total:e.total,data:e.coordinationList}}})})};export{Q as default};
