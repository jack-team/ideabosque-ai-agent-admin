import{D as d,r as G,k as e}from"../chunks/vendor-BASRo5BV.js";import{a as m,f as h}from"../assets/index-BJk3dTtz.js";import{T as x}from"../chunks/index-CDz1kTjP.js";import{g,A as b,W as u,k as A,h as C,l as Q,R as w,a as y,f as D,P as F,S as v,i as I,m as N,B as P}from"../chunks/ui-CrIkMfD8.js";import{I as q}from"../chunks/index-CNAIOIDt.js";import{b as S,u as M}from"../chunks/hooks-Doi3GEEB.js";import{a as f}from"../chunks/generate-C_joZJHY.js";import{R as k}from"../chunks/map-BPCwAIgA.js";import"../chunks/utils-BMDVF5td.js";import"../chunks/index-7RUIiB2k.js";import"../chunks/enum-Ct7sVdAK.js";const U=r=>{if(!r)return;let{questionCriteria:t,...o}=r;const i={...t};return{...o,questionCriteria:Object.keys(i).map(n=>({attribute:n,value:i[n]}))}},R=r=>{const{questionCriteria:t,...o}=r,n=t.reduce((a,s)=>({...a,[s.attribute]:s.value}),{});return{...o,questionCriteria:n,updatedBy:"Admin"}},T=async r=>{const t=await f({type:"Query",name:"questionGroupList"});return m.graphql({query:t,variables:r})},E=async r=>{const t=await f({type:"Mutation",name:"insertUpdateQuestionGroup"});return m.graphql({query:t,variables:r})},B=async r=>{const t=await f({type:"Mutation",name:"deleteQuestionGroup"});return m.graphql({query:t,variables:r})},j=r=>{const{formData:t}=r,[o]=g.useForm(),{message:i}=b.useApp(),[n]=S(),a=d(()=>{o.setFieldsValue(U(t))});return G.useEffect(()=>{t&&a()},[t]),M(async()=>{var l;const s=await o.validateFields(),c=R(s);try{await E(c),n(),(l=r.onSuccess)==null||l.call(r),i.success(`Question Group ${t?"updated":"created"} successfully.`)}catch{i.error(`Failed to ${t?"updated":"created"} Question Group.`)}}),e.jsxs(g,{form:o,submitter:!1,style:{padding:"24px 0 0 0"},children:[e.jsx(u,{hidden:!0,name:"questionGroupUuid"}),e.jsx(u,{label:"Question Group Name",name:"questionGroupName",rules:[{required:!0}]}),e.jsx(A,{label:"Question Group Description",name:"questionGroupDescription",rules:[{required:!0}]}),e.jsx(u,{label:"Weight",name:"weight",rules:[{required:!0}]}),e.jsx(C,{label:"Region",name:"region",valueEnum:k,rules:[{required:!0}]}),e.jsx(Q,{label:"Question Criteria",name:"questionCriteria",className:"custom_form_list",children:e.jsxs(w,{gutter:16,children:[e.jsx(y,{span:12,children:e.jsx(u,{label:"Attribute",name:"attribute",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})}),e.jsx(y,{span:12,children:e.jsx(u,{label:"Value",name:"value",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})})]})})]})},Y=()=>{const{modal:r,message:t}=b.useApp(),o=G.useRef(null),i=d(()=>{var a;(a=o.current)==null||a.reload()}),n=d(a=>{r.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify gray"},onOk:async()=>{try{await B({questionGroupUuid:a.questionGroupUuid}),i(),t.success("Deletion successful.")}catch(s){return t.success("Deletion failed."),Promise.reject(s)}}})});return e.jsx(D,{title:"Question Groups",extra:e.jsx(x,{width:600,className:"shopify",title:"Create Question Group",trigger:e.jsx(P,{className:"shopify",type:"primary",children:"Create Question group"}),children:e.jsx(j,{onSuccess:i})}),children:e.jsx(F,{actionRef:o,search:!1,options:!1,rowKey:"questionGroupUuid",className:"shopify",request:async a=>{const{current:s,pageSize:c,...l}=a,{questionGroupList:p}=await T({limit:c,pageNumber:s,...l});return{total:p.total,data:p.questionGroupList}},columns:[{title:"Question Group UUID",dataIndex:"questionGroupUuid"},{title:"Question Group Name",dataIndex:"questionGroupName"},{title:"Create at",dataIndex:"createdAt",hideInSearch:!0,render:(a,s)=>h(s.createdAt)},{title:"Update at",dataIndex:"updatedAt",hideInSearch:!0,render:(a,s)=>h(s.updatedAt)},{width:"120px",key:"action",title:"Action",align:"center",hideInSearch:!0,render:(a,s)=>e.jsxs(v,{children:[e.jsx(x,{width:620,destroyOnHidden:!0,className:"shopify",title:"Edit Question Groups",trigger:e.jsx(q,{icon:I}),children:e.jsx(j,{formData:s,onSuccess:i})}),e.jsx(q,{icon:N,onClick:()=>n(s)})]})}]})})};export{Y as default};
