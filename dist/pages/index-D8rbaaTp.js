import{C as P,r as v,J as x,D as d,E as C,k as e}from"../chunks/vendor-BASRo5BV.js";import{g as F,r as E,q}from"../assets/index-BJk3dTtz.js";import{S as I}from"../chunks/index-7RUIiB2k.js";import{S as A}from"../chunks/index-RQNN36hI.js";import{g as R}from"../chunks/contactProfiles-BXlgWbp0.js";import{g as _,f as D,h as b,o as M}from"../chunks/ui-CrIkMfD8.js";import"../chunks/utils-BMDVF5td.js";import"../chunks/generate-C_joZJHY.js";const W=()=>P(async()=>{var s;const t=await E(R);return((s=t==null?void 0:t.coordinationList)==null?void 0:s.coordinationList).map(r=>({agents:r.agents,label:r.coordinationName,value:r.coordinationUuid}))}),k=()=>F(),U="_container_ypa08_1",z="_contrl_ypa08_8",B="_preview_ypa08_15",$="_preview_box_ypa08_22",J="_placeholder_ypa08_23",o={container:U,contrl:z,preview:B,preview_box:$,placeholder:J},O="https://shopify-ai-chat.pages.dev",Z=()=>{const[t]=_.useForm(),p=k(),s=v.useRef([]),[r,m]=x(!1),{data:u=[],loading:y}=W(),[c,w]=x(),f=v.useMemo(()=>q.stringify({...c,mode:"preview"}),[c]),j=d(async()=>{const i=await t.validateFields(),g=i.agent,a=s.current.find(n=>n.value===g);w({...i,endpointId:p,agentName:a==null?void 0:a.label})}),S=d(()=>m(!0)),L=d(()=>m(!1));return C(S,[f]),e.jsx(D,{title:"Preview",className:"shopify full-screen",children:e.jsxs("div",{className:o.container,children:[e.jsx("div",{className:o.preview,children:e.jsx(A,{loading:r,children:e.jsx("div",{className:o.preview_box,children:c?e.jsx("iframe",{width:"100%",height:"100%",allow:"geolocation;",onLoad:L,src:`${O}?${f}`}):e.jsx("div",{className:o.placeholder,children:"Please select Coordination and Agency to preview."})})})}),e.jsx("div",{className:o.contrl,children:e.jsxs(_,{form:t,submitter:!1,className:o.form,children:[e.jsx(b,{label:"Coordination",name:"coordination",options:u,fieldProps:{placement:"bottomRight",popupMatchSelectWidth:!1,loading:y,onChange:()=>{t.resetFields(["agent"])}},rules:[{required:!0}]}),e.jsx(M,{name:["coordination"],children:({coordination:i})=>{var a;if(!i)return null;const l=(((a=u.find(n=>n.value===i))==null?void 0:a.agents)||[]).map(n=>{const N=n.agent_name,h=n.agent_uuid;return{label:N||h,value:h}});return s.current=l,e.jsx(b,{label:"Agent",name:"agent",options:l,fieldProps:{placement:"bottomLeft",popupMatchSelectWidth:!1},rules:[{required:!0}]})}}),e.jsx("div",{className:o.submitter,children:e.jsx(I,{block:!0,type:"primary",size:"large",onClick:j,children:"Apply"})})]})})]})})};export{Z as default};
