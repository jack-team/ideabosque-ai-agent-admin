import{L as q,K as N,M as k,J as j,D as f,r as A,k as e}from"../chunks/vendor-BASRo5BV.js";import{f as L,i as U}from"../chunks/workflow-Ceki6VW7.js";import{a as M,b as W}from"../chunks/useFetchData-D4J-x63P.js";import{S as B}from"../chunks/index-E3aGMyob.js";import"../assets/index-a3n_qMTh.js";import{g as h,A as E,f as R,W as l,R as y,a as o,h as x,k as g,l as V,S as O}from"../chunks/ui-CrIkMfD8.js";import{S as z}from"../chunks/index-B4mFbccR.js";import{a as J}from"../chunks/const-DP1vyTQS.js";import"../chunks/generate-BNkr4RNj.js";import"../chunks/wizard-BPNZXcgu.js";import"../chunks/enum-Ct7sVdAK.js";import"../chunks/utils-BMDVF5td.js";const v="__",K=s=>{const a=s.mcpServers.map(r=>r.mcp_server_uuid),n=s.uiComponents.map(r=>[r.ui_component_uuid,r.ui_component_type].join(v));return{...s,mcpServers:a,uiComponents:n}},G=s=>{const a=s.mcpServers||[],n=s.uiComponents||[],r=a.map(i=>({mcp_server_uuid:i})),c=n.map(i=>{const[u,m]=i.split(v);return{ui_component_uuid:u,ui_component_type:m}});return{...s,mcpServers:r,uiComponents:c,updatedBy:"admin"}},H="_wrapper_ytw7y_1",I="_form_ytw7y_4",Q="_form_list_ytw7y_11",_={wrapper:H,form:I,form_list:Q},pe=()=>{const[s]=h.useForm(),{message:a}=E.useApp(),{state:n}=q(),r=N(),{uid:c,vid:i}=k(),[u,m]=j(!1),{options:S,loading:T}=M(),{options:w,loading:b}=W(),[t,P]=j(n),C=f(async()=>{const{promptTemplate:p}=await L({promptUuid:c,promptVersionUuid:i});P(p)}),D=f(()=>{const p=K(t);s.setFieldsValue(p)}),F=f(async()=>{const p=await s.validateFields();try{m(!0);const d=G(p);await U(d),a.success("Template saved successfully.")}catch(d){a.error(d.message)}finally{m(!1)}});return A.useEffect(()=>{t?D():C()},[t]),e.jsx(B,{loading:!t,children:e.jsx(R,{title:t==null?void 0:t.promptName,className:"shopify full-screen",onBack:()=>r(-1),extra:e.jsx(O,{children:e.jsx(z,{type:"primary",loading:u,disabled:!t,onClick:F,children:"Save"})}),children:e.jsx("div",{className:_.wrapper,children:e.jsxs(h,{form:s,submitter:!1,className:_.form,children:[e.jsx(l,{hidden:!0,name:"promptUuid"}),e.jsxs(y,{gutter:16,children:[e.jsx(o,{span:24,children:e.jsx(l,{label:"Template Name",name:"promptName",rules:[{required:!0}]})}),e.jsx(o,{span:24,children:e.jsx(x,{label:"Type",name:"promptType",valueEnum:J,rules:[{required:!0}]})}),e.jsx(o,{span:24,children:e.jsx(x,{label:"Mcp Servers",name:"mcpServers",mode:"multiple",options:w,rules:[{required:!0}],fieldProps:{loading:b}})}),e.jsx(o,{span:24,children:e.jsx(x,{label:"Ui Components",name:"uiComponents",mode:"multiple",options:S,rules:[{required:!0}],fieldProps:{loading:T}})})]}),e.jsx(g,{label:"Template Description",name:"promptDescription",fieldProps:{rows:12},rules:[{required:!0}]}),e.jsx(g,{label:"Template Context",name:"templateContext",fieldProps:{rows:12},rules:[{required:!0}]}),e.jsx(V,{label:"Variables",name:"variables",className:_.form_list,children:e.jsxs(y,{gutter:16,children:[e.jsx(o,{span:12,children:e.jsx(l,{name:"name",placeholder:"Variable Name",rules:[{required:!0}]})}),e.jsx(o,{span:12,children:e.jsx(l,{name:"data_type",placeholder:"Data type",rules:[{required:!0}]})})]})})]})})})})};export{pe as default};
