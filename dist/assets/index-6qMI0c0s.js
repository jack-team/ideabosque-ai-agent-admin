import{l as j,u as t,b as l,w as v,Z as E,_ as B,$ as F,j as o,M as P,v as N,i as R,B as z}from"./libs-DoyQQ7D9.js";import{T,S as U}from"./index-fj5aKeTe.js";const A=e=>{const[s,n]=j(!1),a=t(()=>{n(!0)}),c=t(()=>{n(!1)});return e=l.cloneElement(e,{onClick:a}),{open:s,trigger:e,onClose:c,onOpen:a}},M=()=>l.useContext(T),_=()=>[l.useRef({closeModal:()=>null,openModal:()=>null}).current],$=e=>{const{event:s}=M(),n=t(e);v(()=>s.on("ok",n)),E(()=>s.off("ok",n))},q=e=>{const{event:s}=M(),n=t(e);v(()=>s.on("cancel",n)),E(()=>s.off("cancel",n))},D=()=>{const{closeModal:e}=M();return[e]},G=e=>{const{modal:s,okText:n,onOpen:a,onClose:c,trigger:r,className:p,hasFooter:h=!0,cancelText:f="Back",showCancel:m=!0,...x}=e,{open:i,onClose:d,onOpen:S,trigger:b}=A(r),g=l.useMemo(()=>new B,[]),C=t((u,O)=>g.listeners(u).map(L=>L(O))),w=t(async u=>{await Promise.all(C("ok",u))}),k=t(async u=>{await Promise.all(C("cancel",u)),d()});return l.useEffect(()=>{s&&(s.closeModal=d,s.openModal=S)},[s]),F(()=>{i?a==null||a():c==null||c()},[i]),o.jsxs(T.Provider,{value:{event:g,closeModal:d},children:[b,o.jsx(P,{...x,open:i,onCancel:k,className:N("shopify",p),footer:h?o.jsxs(l.Fragment,{children:[o.jsx(y,{type:"text",children:f,onClick:k,icon:o.jsx(R,{}),className:m?"":"visb-hide"}),o.jsx(y,{type:"primary",children:n,onClick:w})]}):null})]})},y=e=>{const{icon:s,loading:n,className:a,children:c,onClick:r,...p}=e,[h,f]=j(n),m=n||h,x=t(async i=>{if(!n){f(!0);try{await(r==null?void 0:r(i))}catch(d){console.error(d)}finally{f(!1)}}});return o.jsx(z,{...p,onClick:x,icon:m?o.jsx(U,{size:20,color:"#aaa"}):s,className:N("shopify",a,m&&"ant-btn-loading"),children:o.jsx("span",{className:"ant-btn-children",children:c})})};export{y as S,G as T,_ as a,q as b,D as c,A as d,$ as u};
