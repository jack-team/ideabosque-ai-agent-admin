import{q as x,A as W,u as f,b as T,j as e,W as p,s as h,x as z,t as D,p as P,P as b,S as y,B as c}from"./libs-DKvGRd2v.js";import{f as w}from"./index-hLuO1L00.js";import{T as g}from"./index-BVeCJB01.js";import{W as A}from"./map-BJxYnWC7.js";import{b as F,u as S}from"./hooks-D-cV3eAe.js";import{a as I,b as U,c as N}from"./wizard-Dw4k91bU.js";import{l as C}from"./useFetchData-D6kGbjfh.js";import"./index-O1RFasQ-.js";import"./enum-Ct7sVdAK.js";import"./generate-DahBUJdW.js";import"./workflow-v4leCDxK.js";const E=a=>{if(!a)return;const{elements:s,...i}=a,o=s.map(n=>n.element_uuid);return{...i,elementUuids:o}},k=a=>({...a,updatedBy:"Admin"}),j=a=>{const{formData:s}=a,[i]=x.useForm(),{message:o}=W.useApp(),[n]=F(),d=C(),r=f(()=>{i.setFieldsValue(E(s))});return T.useEffect(()=>{s&&r()},[s]),S(async()=>{var l;const t=await i.validateFields(),u=k(t);try{await I(u),n(),(l=a.onSuccess)==null||l.call(a),o.success(`Wizard ${s?"updated":"created"} successfully.`)}catch{o.error(`Failed to ${s?"update":"create"} Wizard.`)}}),e.jsxs(x,{form:i,layout:"horizontal",submitter:!1,labelCol:{flex:"170px"},labelAlign:"left",style:{padding:"24px 0 0 0"},children:[e.jsx(p,{hidden:!0,name:"wizardUuid"}),e.jsx(p,{label:"Wizard Title",name:"wizardTitle",rules:[{required:!0}]}),e.jsx(h,{label:"Wizard Type",name:"wizardType",valueEnum:A,rules:[{required:!0}]}),e.jsx(z,{label:"Wizard Description",name:"wizardDescription",fieldProps:{rows:8},rules:[{required:!0}]}),e.jsx(p,{label:"Priority",name:"priority",fieldProps:{type:"number"},rules:[{required:!0}]}),e.jsx(z,{label:"Form Schema",name:"formSchema",fieldProps:{rows:8}}),e.jsx(h,{label:"Elements",name:"elementUuids",mode:"multiple",options:d.options,fieldProps:{maxTagCount:1,loading:d.loading}})]})},V=()=>{const{modal:a,message:s}=W.useApp(),i=D(),o=T.useRef(null),n=f(()=>{var r;(r=o.current)==null||r.reload()}),d=f(r=>{a.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify"},onOk:async()=>{try{await N({wizardUuid:r.wizardUuid}),n(),s.success("Deletion successful.")}catch(t){return s.success("Deletion failed."),Promise.reject(t)}}})});return e.jsx(P,{title:"Wizard List",onBack:()=>i(-1),extra:e.jsxs(y,{size:16,children:[e.jsx(c,{className:"shopify",onClick:()=>i("/elements"),children:"Elements"}),e.jsx(g,{width:600,className:"shopify",title:"Create Wizard",trigger:e.jsx(c,{className:"shopify",type:"primary",children:"Create Wizard"}),children:e.jsx(j,{})})]}),children:e.jsx(b,{actionRef:o,search:!1,options:!1,scroll:{x:"max-content"},rowKey:"wizardUuid",className:"shopify",request:async r=>{const{current:t,pageSize:u,...l}=r,{wizardList:m}=await U({limit:u,pageNumber:t,...l});return{total:m.total,data:m.wizardList}},columns:[{title:"Wizard UUID",dataIndex:"wizardUuid",hideInSearch:!0},{title:"Wizard Title",dataIndex:"wizardTitle"},{title:"Wizard Type",dataIndex:"wizardType",valueEnum:A},{width:"300px",hideInSearch:!0,title:"Wizard Description",dataIndex:"wizardDescription"},{title:"Create at",dataIndex:"createdAt",hideInSearch:!0,render:(r,t)=>w(t.createdAt)},{title:"Update at",dataIndex:"updatedAt",hideInSearch:!0,render:(r,t)=>w(t.updatedAt)},{width:"120px",key:"action",title:"Action",align:"center",fixed:"right",hideInSearch:!0,render:(r,t)=>e.jsxs(y,{children:[e.jsx(g,{width:600,destroyOnHidden:!0,className:"shopify",title:"Update Wizard",trigger:e.jsx(c,{size:"small",type:"primary",className:"shopify",children:"Edit"}),children:e.jsx(j,{formData:t,onSuccess:n})}),e.jsx(c,{danger:!0,size:"small",className:"shopify",onClick:()=>d(t),children:"Delete"})]})}]})})};export{V as default};
