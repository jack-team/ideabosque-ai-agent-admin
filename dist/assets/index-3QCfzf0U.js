import{r as a,bY as y,bZ as P,j as o,d as C,B as z,aJ as I}from"./index-Ba_g2vaY.js";import{I as E,u as r}from"./index-nfNs6mj5.js";import{u as L,M as $}from"./index-BbGm5IzQ.js";var F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},H={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"};function v(){return v=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},v.apply(this,arguments)}const U=(e,n)=>a.createElement(E,v({},e,{ref:n,icon:F})),_=a.forwardRef(U);function x(){return x=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},x.apply(this,arguments)}const J=(e,n)=>a.createElement(E,x({},e,{ref:n,icon:H})),V=a.forwardRef(J);var Y=function(e){return function(n,t){var s=a.useRef(!1);e(function(){return function(){s.current=!1}},[]),e(function(){if(!s.current)s.current=!0;else return n()},t)}};const Z=Y(a.useEffect);function q(e){var n=a.useRef(e);return n.current=e,n}var R=function(e){var n=q(e);a.useEffect(function(){return function(){n.current()}},[])},k=function(e){a.useEffect(function(){e==null||e()},[])};const D=e=>{const[n,t]=L(!1),s=r(()=>{t(!0)}),c=r(()=>{t(!1)});return e=a.cloneElement(e,{onClick:s}),{open:n,trigger:e,onClose:c,onOpen:s}},M=()=>a.useContext(y),W=()=>[a.useRef({closeModal:()=>null,openModal:()=>null}).current],X=e=>{const{event:n}=M(),t=r(e);k(()=>n.on("ok",t)),R(()=>n.off("ok",t))},ee=e=>{const{event:n}=M(),t=r(e);k(()=>n.on("cancel",t)),R(()=>n.off("cancel",t))},ne=()=>{const{closeModal:e}=M();return[e]},te=e=>{const{modal:n,okText:t,onOpen:s,onClose:c,trigger:l,className:m,hasFooter:p=!0,cancelText:d="Back",showCancel:h=!0,...g}=e,{open:i,onClose:u,onOpen:N,trigger:T}=D(l),O=a.useMemo(()=>new P,[]),b=r((f,S)=>O.listeners(f).map(A=>A(S))),B=r(async f=>{await Promise.all(b("ok",f))}),j=r(async f=>{await Promise.all(b("cancel",f)),u()});return a.useEffect(()=>{n&&(n.closeModal=u,n.openModal=N)},[n]),Z(()=>{i?s==null||s():c==null||c()},[i]),o.jsxs(y.Provider,{value:{event:O,closeModal:u},children:[T,o.jsx($,{...g,open:i,onCancel:j,className:C("shopify",m),footer:p?o.jsxs(a.Fragment,{children:[o.jsx(w,{type:"text",children:d,onClick:j,icon:o.jsx(_,{}),className:h?"":"visb-hide"}),o.jsx(w,{type:"primary",children:t,onClick:B})]}):null})]})},w=e=>{const{icon:n,loading:t,className:s,children:c,onClick:l,...m}=e,[p,d]=L(t),h=t||p,g=r(async i=>{if(!t){d(!0);try{await(l==null?void 0:l(i))}catch(u){console.error(u)}finally{d(!1)}}});return o.jsx(z,{...m,onClick:g,icon:h?o.jsx(I,{size:20,color:"#aaa"}):n,className:C("shopify",s,h&&"ant-btn-loading"),children:o.jsx("span",{className:"ant-btn-children",children:c})})};export{_ as R,w as S,te as T,V as a,W as b,ee as c,ne as d,k as e,D as f,X as u};
