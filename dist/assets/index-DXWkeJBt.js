import{v as l,A as y,j as o,W as u,F as h,w as C,b as j,e as m,t as A,P as D,S as N,ao as P,ar as F,B as w}from"./libs-Da1xhxe8.js";import"./index-BDycVQol.js";import{T as p}from"./index-CToefxk5.js";import{I as g}from"./index-Cm1ycU0f.js";import{f}from"./index-WkG41BTg.js";import{j as S}from"./useFetchData-C8f7xBZN.js";import{b as I,u as T}from"./hooks-Dx89hw0v.js";import{i as U,d as b,g as _}from"./contactProfiles-SMKbisw2.js";import"./index-deFZkbnd.js";import"./workflow-DgnxqJ1H.js";import"./generate-D8LX3fmF.js";import"./wizard-FFaH7Gsj.js";import"./enum-Ct7sVdAK.js";const k=a=>{if(!a)return;const{agents:s=[],...r}=a;return{...r,agents:s.map(n=>n.agent_uuid)}},v=(a,s)=>{const{agents:r=[],...n}=a,i=r.map(t=>{var d;const e=(d=s.find(c=>c.value===t))==null?void 0:d.realData;return{agent_uuid:t,agent_type:"task",agent_name:e==null?void 0:e.agentName,agent_description:e==null?void 0:e.agentDescription}});return{...n,agents:i,updatedBy:"Admin"}},x=a=>{const{formData:s}=a,[r]=l.useForm(),{message:n}=y.useApp(),[i]=I(),t=S();return T(async()=>{var d;const e=await r.validateFields();try{const c=v(e,t.options);await U(c),n.success("Coordination created successfully."),i(),(d=a.onSuccess)==null||d.call(a)}catch{n.error("Failed to create Coordination.")}}),o.jsxs(l,{form:r,submitter:!1,style:{padding:"24px 0 0 0"},initialValues:k(s),children:[o.jsx(u,{name:"coordinationUuid",hidden:!0}),o.jsx(u,{required:!1,label:"Coordination Name",name:"coordinationName",rules:[{required:!0}]}),o.jsx(h,{required:!1,label:"Coordination Description",name:"coordinationDescription",rules:[{required:!0}]}),o.jsx(C,{label:"Connected agents",name:"agents",mode:"multiple",options:t.options,fieldProps:{maxTagCount:1,loading:t.loading}})]})},J=()=>{const{modal:a,message:s}=y.useApp(),r=j.useRef(null),n=m(()=>{var t;(t=r.current)==null||t.reload()}),i=m(t=>{a.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify"},onOk:async()=>{try{await b({coordinationUuid:t.coordinationUuid}),n(),s.success("Deletion successful.")}catch(e){return s.error("Deletion failed."),Promise.reject(e)}}})});return o.jsx(A,{className:"shopify",title:"Coordinations",extra:o.jsx(p,{width:620,destroyOnHidden:!0,className:"shopify",title:"Create Coordination",trigger:o.jsx(w,{className:"shopify",type:"primary",children:"Create coordination"}),children:o.jsx(x,{onSuccess:n})}),children:o.jsx(D,{actionRef:r,className:"shopify",options:!1,size:"small",search:!1,pagination:{defaultPageSize:5},rowKey:"coordinationUuid",columns:[{title:"Coordination UUID",dataIndex:"coordinationUuid"},{title:"Coordination Name",dataIndex:"coordinationName"},{title:"Create at",dataIndex:"createAt",render:(t,e)=>f(e.createAt)},{title:"Update at",dataIndex:"updateAt",render:(t,e)=>f(e.updateAt)},{width:120,title:"Actions",key:"action",render:(t,e)=>o.jsxs(N,{children:[o.jsx(p,{width:620,destroyOnHidden:!0,className:"shopify",title:"Edit Coordination",trigger:o.jsx(g,{icon:P}),children:o.jsx(x,{formData:e,onSuccess:n})}),o.jsx(g,{danger:!0,icon:F,onClick:()=>i(e)})]})}],request:async t=>{const{coordinationList:e}=await _({limit:t.pageSize,pageNumber:t.current});return{total:e.total,data:e.coordinationList}}})})};export{J as default};
