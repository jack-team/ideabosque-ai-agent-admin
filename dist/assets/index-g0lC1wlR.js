import{m as T,u as a,b as r,aq as b,af as F,j as t,M as R,ag as B,k as q}from"./libs-Clw9C49h.js";import{T as z}from"./index-D3QcqB_5.js";import{S as E}from"./index-DxFRfNm6.js";const I=l=>{const[e,s]=T(!1),o=a(()=>s(!0)),u=a(f=>{var c,i;o(),(i=(c=l.props).onClick)==null||i.call(c,f)}),p=a(()=>{s(!1)}),d=r.cloneElement(l,{onClick:u});return{open:e,onOpen:o,onClose:p,trigger:d}},G=l=>{const{modal:e,onOpen:s,onClose:o,trigger:u,className:p,rootClassName:d,okText:f="Save",hasFooter:c=!0,cancelText:i="Back",showCancel:v=!0,...g}=l,[m,k]=T(!1),{open:x,onClose:h,onOpen:N,trigger:S}=I(u),w=r.useMemo(()=>m?{...g,closable:!1}:g,[g,m]),M=r.useMemo(()=>new b,[]),j=a((n,C)=>M.listeners(n).map(P=>P(C))),O=a(async n=>{k(!0);try{await Promise.all(j("ok",n))}catch(C){console.error(C)}k(!1)}),y=a(async n=>{m||(await Promise.all(j("cancel",n)),h())});return r.useEffect(()=>{e&&(e.closeModal=h,e.openModal=N)},[e]),F(()=>{x?s==null||s():o==null||o()},[x]),t.jsxs(z.Provider,{value:{event:M,closeModal:h},children:[S,t.jsx(R,{...w,open:x,onCancel:y,rootClassName:B("shopify",d),className:p,footer:c?t.jsxs(r.Fragment,{children:[t.jsx(E,{type:"text",children:i,onClick:y,icon:t.jsx(q,{}),className:!v||m?"visb-hide":""}),t.jsx(E,{type:"primary",children:f,onClick:O})]}):null})]})};export{G as T,I as u};
