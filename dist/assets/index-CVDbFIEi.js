import{y as m,A as h,j as e,W as y,z as g,w as A,b as I,f as c,x as F,P as k,i as P,S as u,D as b,F as C}from"./libs-BaOSQqCJ.js";import"./index-DTADpAFe.js";import{T as x}from"./index-DKUEh0z3.js";import{S as d}from"./index-BMRnIUQf.js";import{I as f}from"./index-CjwgjA-6.js";import{i as T,q as M}from"./workflow-B_nGYIaA.js";import{T as U,a as j}from"./const-DP1vyTQS.js";import{S}from"./enum-Ct7sVdAK.js";import{b as v,u as w}from"./hooks-HQZQxy-z.js";import{S as N}from"./index-CMom6Ve6.js";import{u as _}from"./useFetchData-CZvRU8h_.js";import"./generate-BQHSwzam.js";import"./wizard-BDsquuTS.js";const V="_edit_form_k8an2_1",D={edit_form:V},q=a=>{const[o]=m.useForm(),{message:n}=h.useApp(),[i]=v();return w(async()=>{var s;const t=await o.validateFields();try{const{insertUpdatePromptTemplate:r}=await T({...t,templateContext:"",updatedBy:"Admin"});i(),(s=a.onSuccess)==null||s.call(a,r.promptTemplate)}catch(r){return n.error(r.message),Promise.reject(r)}}),e.jsxs(m,{form:o,submitter:!1,className:D.edit_form,children:[e.jsx(y,{label:"Template name",name:"promptName",rules:[{required:!0}]}),e.jsx(g,{label:"Template type",name:"promptType",valueEnum:j,initialValue:U.SystemPrompt,rules:[{required:!0}]})]})},B=a=>{const{formData:o}=a,[n]=m.useForm(),{message:i}=h.useApp(),[t]=v();w(async()=>{var l;const p=await n.validateFields();try{await T({...p,status:S.Active,updatedBy:"Admin"}),t(),(l=a.onSuccess)==null||l.call(a),i.success("The version has been applied successfully.")}catch{i.error("The version application failed.")}});const{options:s,loading:r}=_(o==null?void 0:o.promptUuid);return e.jsx(m,{form:n,initialValues:o,submitter:!1,style:{padding:"24px 0 0 0"},children:e.jsxs(N,{loading:r,children:[e.jsx(y,{hidden:!0,name:"promptUuid"}),e.jsx(g,{label:"Versions",name:"promptVersionUuid",options:s,fieldProps:{loading:r},rules:[{required:!0}]})]})})},Z=()=>{const a=A(),o=I.useRef(null),n=c(()=>{var t;(t=o.current)==null||t.reload()}),i=c(t=>{const{promptUuid:s,promptVersionUuid:r}=t;a(`/workflow-templates/detail/${s}/${r}`,{state:t})});return e.jsx(F,{className:"shopify",title:"Featured templates",extra:e.jsxs(u,{size:16,children:[e.jsx(d,{className:"gray",onClick:()=>a("/workflow-mcp-servers"),children:"Mcp Servers"}),e.jsx(d,{className:"gray",onClick:()=>a("/workflow-ui-components"),children:"Components"}),e.jsx(x,{width:400,destroyOnHidden:!0,title:"Create template",trigger:e.jsx(d,{type:"primary",children:"Create Template"}),children:e.jsx(q,{onSuccess:i})})]}),children:e.jsx(k,{className:"shopify",rowKey:"promptUuid",actionRef:o,options:!1,search:!1,pagination:{defaultPageSize:5},columns:[{dataIndex:"promptName",title:"Template",fixed:"left"},{hideInSearch:!0,dataIndex:"promptType",title:"Type",valueEnum:j},{dataIndex:"promptDescription",title:"Description",hideInSearch:!0},{dataIndex:"updatedAt",title:"Updated at",hideInSearch:!0,render:(t,s)=>P(s.updatedAt).format("YYYY/MM/DD HH:mm:ss")},{dataIndex:"updatedBy",title:"Updated by",hideInSearch:!0},{key:"action",title:"Action",width:"100px",align:"center",hideInSearch:!0,fixed:"right",render:(t,s)=>e.jsxs(u,{children:[e.jsx(f,{icon:b,onClick:()=>i(s)}),e.jsx(x,{width:400,title:"Versions",destroyOnHidden:!0,okText:"Apply",trigger:e.jsx(f,{icon:C}),children:e.jsx(B,{formData:s,onSuccess:n})})]})}],scroll:{x:"max-content"},request:async t=>{const{current:s=1,pageSize:r=10,...p}=t,{promptTemplateList:l}=await M({pageNumber:s,limit:r,statuses:[S.Active],...p});return{total:l.total,data:l.promptTemplateList}}})})};export{Z as default};
