import{m as N,l as t,b as l,y as v,a0 as E,a1 as F,a2 as P,j as o,M as R,x as T,i as z,B as U}from"./libs-a68GZHSj.js";import{T as S,S as A}from"./index-B2CbedWA.js";const I=e=>{const[s,n]=N(!1),a=t(()=>{n(!0)}),c=t(()=>{n(!1)});return e=l.cloneElement(e,{onClick:a}),{open:s,trigger:e,onClose:c,onOpen:a}},C=()=>l.useContext(S),G=()=>[l.useRef({closeModal:()=>null,openModal:()=>null}).current],H=e=>{const{event:s}=C(),n=t(e);v(()=>s.on("ok",n)),E(()=>s.off("ok",n))},J=e=>{const{event:s}=C(),n=t(e);v(()=>s.on("cancel",n)),E(()=>s.off("cancel",n))},K=()=>{const{closeModal:e}=C();return[e]},Q=e=>{const{modal:s,okText:n,onOpen:a,onClose:c,trigger:r,className:m,rootClassName:p,hasFooter:u=!0,cancelText:f="Back",showCancel:x=!0,...h}=e,{open:i,onClose:M,onOpen:b,trigger:O}=I(r),g=l.useMemo(()=>new F,[]),y=t((d,L)=>g.listeners(d).map(B=>B(L))),w=t(async d=>{await Promise.all(y("ok",d))}),k=t(async d=>{await Promise.all(y("cancel",d)),M()});return l.useEffect(()=>{s&&(s.closeModal=M,s.openModal=b)},[s]),P(()=>{i?a==null||a():c==null||c()},[i]),o.jsxs(S.Provider,{value:{event:g,closeModal:M},children:[O,o.jsx(R,{...h,open:i,onCancel:k,rootClassName:T("shopify",p),className:m,footer:u?o.jsxs(l.Fragment,{children:[o.jsx(j,{type:"text",children:f,onClick:k,icon:o.jsx(z,{}),className:x?"":"visb-hide"}),o.jsx(j,{type:"primary",children:n,onClick:w})]}):null})]})},j=e=>{const{icon:s,loading:n,className:a,children:c,onClick:r,...m}=e,[p,u]=N(n),f=n||p,x=t(async h=>{if(!n){u(!0);try{await(r==null?void 0:r(h))}catch(i){console.error(i)}finally{u(!1)}}});return o.jsx(U,{...m,onClick:x,icon:f?o.jsx(A,{size:20,color:"#aaa"}):s,className:T("shopify",a,f&&"ant-btn-loading"),children:o.jsx("span",{className:"ant-btn-children",children:c})})};export{j as S,Q as T,G as a,K as b,J as c,I as d,H as u};
