import{q as m,A as x,j as e,W as y,s as T,t as A,b as k,u as c,p as b,P as C,d as F,S as u,B as f}from"./libs-ChT4hEeZ.js";import"./index-CRzCV8gh.js";import{T as h}from"./index-Lurxt14A.js";import{S as d}from"./index-DIMjatY4.js";import{i as j,q as P}from"./workflow-D-zbS7FU.js";import{T as I,a as g}from"./const-DP1vyTQS.js";import{S}from"./enum-Ct7sVdAK.js";import{b as v,u as w}from"./hooks-PXMSJGZu.js";import{S as M}from"./index-CbDiQ6FV.js";import{u as U}from"./useFetchData-jhf_de0x.js";import"./generate-BfFboeQH.js";import"./wizard-DNvM4GDM.js";const N="_edit_form_k8an2_1",V={edit_form:N},_=r=>{const[o]=m.useForm(),{message:n}=x.useApp(),[i]=v();return w(async()=>{var s;const t=await o.validateFields();try{const{insertUpdatePromptTemplate:a}=await j({...t,templateContext:"",updatedBy:"Admin"});i(),(s=r.onSuccess)==null||s.call(r,a.promptTemplate)}catch(a){return n.error(a.message),Promise.reject(a)}}),e.jsxs(m,{form:o,submitter:!1,className:V.edit_form,children:[e.jsx(y,{label:"Template name",name:"promptName",rules:[{required:!0}]}),e.jsx(T,{label:"Template type",name:"promptType",valueEnum:g,initialValue:I.SystemPrompt,rules:[{required:!0}]})]})},q=r=>{const{formData:o}=r,[n]=m.useForm(),{message:i}=x.useApp(),[t]=v();w(async()=>{var l;const p=await n.validateFields();try{await j({...p,status:S.Active,updatedBy:"Admin"}),t(),(l=r.onSuccess)==null||l.call(r),i.success("The version has been applied successfully.")}catch{i.error("The version application failed.")}});const{options:s,loading:a}=U(o==null?void 0:o.promptUuid);return e.jsx(m,{form:n,initialValues:o,submitter:!1,style:{padding:"24px 0 0 0"},children:e.jsxs(M,{loading:a,children:[e.jsx(y,{hidden:!0,name:"promptUuid"}),e.jsx(T,{label:"Versions",name:"promptVersionUuid",options:s,fieldProps:{loading:a},rules:[{required:!0}]})]})})},J=()=>{const r=A(),o=k.useRef(null),n=c(()=>{var t;(t=o.current)==null||t.reload()}),i=c(t=>{const{promptUuid:s,promptVersionUuid:a}=t;r(`/workflow-templates/detail/${s}/${a}`,{state:t})});return e.jsx(b,{className:"shopify",title:"Workflow Templates",extra:e.jsxs(u,{size:16,children:[e.jsx(d,{onClick:()=>r("/workflow-mcp-servers"),children:"Mcp Servers"}),e.jsx(d,{onClick:()=>r("/workflow-ui-components"),children:"Components"}),e.jsx(h,{width:400,destroyOnHidden:!0,title:"Create template",trigger:e.jsx(d,{type:"primary",children:"Create Template"}),children:e.jsx(_,{onSuccess:i})})]}),children:e.jsx(C,{className:"shopify",rowKey:"promptUuid",actionRef:o,options:!1,search:!1,columns:[{dataIndex:"promptName",title:"Template",fixed:"left"},{hideInSearch:!0,dataIndex:"promptType",title:"Type",valueEnum:g},{dataIndex:"promptDescription",title:"Description",hideInSearch:!0},{dataIndex:"updatedAt",title:"Updated at",hideInSearch:!0,render:(t,s)=>F(s.updatedAt).format("YYYY/MM/DD HH:mm:ss")},{dataIndex:"updatedBy",title:"Updated by",hideInSearch:!0},{key:"action",title:"Action",width:"100px",align:"center",hideInSearch:!0,fixed:"right",render:(t,s)=>e.jsxs(u,{children:[e.jsx(f,{size:"small",type:"primary",className:"shopify",onClick:()=>i(s),children:"Edit"}),e.jsx(h,{width:400,title:"Versions",destroyOnHidden:!0,okText:"Apply",trigger:e.jsx(f,{size:"small",className:"shopify",children:"Versions"}),children:e.jsx(q,{formData:s,onSuccess:n})})]})}],scroll:{x:"max-content"},request:async t=>{const{current:s=1,pageSize:a=10,...p}=t,{promptTemplateList:l}=await P({pageNumber:s,limit:a,statuses:[S.Active],...p});return{total:l.total,data:l.promptTemplateList}}})})};export{J as default};
