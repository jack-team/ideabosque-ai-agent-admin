import{y as l,A as y,j as o,W as u,J as h,z as C,b as j,h as m,x as A,P as D,S as N,D as P,L as F,B as S}from"./libs-NYaGYdqa.js";import{f as p}from"./index-CD538xby.js";import{T as g}from"./index-DSjh7nxU.js";import{I as f}from"./index-CCG6JdoO.js";import{j as w}from"./useFetchData-DwlIBHXS.js";import{b as I,u as T}from"./hooks-Dep68YsA.js";import{i as U,d as b,g as _}from"./contactProfiles-BKmdABjS.js";import"./index-CXsHAlaF.js";import"./workflow-DZG1gzQi.js";import"./generate-CrLfPIAK.js";import"./wizard-CZUEWCOW.js";import"./enum-Ct7sVdAK.js";const k=a=>{if(!a)return;const{agents:i=[],...s}=a;return{...s,agents:i.map(n=>n.agent_uuid)}},v=(a,i)=>{const{agents:s=[],...n}=a,r=s.map(t=>{var d;const e=(d=i.find(c=>c.value===t))==null?void 0:d.realData;return{agent_uuid:t,agent_type:"task",agent_name:e==null?void 0:e.agentName,agent_description:e==null?void 0:e.agentDescription}});return{...n,agents:r,updatedBy:"Admin"}},x=a=>{const{formData:i}=a,[s]=l.useForm(),{message:n}=y.useApp(),[r]=I(),t=w();return T(async()=>{var d;const e=await s.validateFields();try{const c=v(e,t.options);await U(c),n.success("Coordination created successfully."),r(),(d=a.onSuccess)==null||d.call(a)}catch{n.error("Failed to create Coordination.")}}),o.jsxs(l,{form:s,submitter:!1,style:{padding:"24px 0 0 0"},initialValues:k(i),children:[o.jsx(u,{name:"coordinationUuid",hidden:!0}),o.jsx(u,{required:!1,label:"Coordination Name",name:"coordinationName",rules:[{required:!0}]}),o.jsx(h,{required:!1,label:"Coordination Description",name:"coordinationDescription",rules:[{required:!0}]}),o.jsx(C,{label:"Connected agents",name:"agents",mode:"multiple",options:t.options,fieldProps:{maxTagCount:1,loading:t.loading}})]})},V=()=>{const{modal:a,message:i}=y.useApp(),s=j.useRef(null),n=m(()=>{var t;(t=s.current)==null||t.reload()}),r=m(t=>{a.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify gray"},onOk:async()=>{try{await b({coordinationUuid:t.coordinationUuid}),n(),i.success("Deletion successful.")}catch(e){return i.error("Deletion failed."),Promise.reject(e)}}})});return o.jsx(A,{className:"shopify",title:"Coordinations",extra:o.jsx(g,{width:620,destroyOnHidden:!0,className:"shopify",title:"Add Coordination",trigger:o.jsx(S,{className:"shopify",type:"primary",children:"Add coordination"}),children:o.jsx(x,{onSuccess:n})}),children:o.jsx(D,{actionRef:s,className:"shopify",options:!1,size:"small",search:!1,pagination:{defaultPageSize:4},rowKey:"coordinationUuid",scroll:{x:"max-content"},columns:[{title:"Coordination UUID",dataIndex:"coordinationUuid"},{title:"Coordination Name",dataIndex:"coordinationName"},{title:"Create at",dataIndex:"createAt",render:(t,e)=>p(e.createAt)},{title:"Update at",dataIndex:"updateAt",render:(t,e)=>p(e.updateAt)},{width:100,title:"Actions",key:"action",fixed:"right",render:(t,e)=>o.jsxs(N,{children:[o.jsx(g,{width:620,destroyOnHidden:!0,className:"shopify",title:"Edit Coordination",trigger:o.jsx(f,{icon:P}),children:o.jsx(x,{formData:e,onSuccess:n})}),o.jsx(f,{icon:F,onClick:()=>r(e)})]})}],request:async t=>{const{coordinationList:e}=await _({limit:t.pageSize,pageNumber:t.current});return{total:e.total,data:e.coordinationList}}})})};export{V as default};
