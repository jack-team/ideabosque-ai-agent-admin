import{l as N,u as t,b as l,x as v,$ as E,a0 as F,a1 as P,j as o,M as R,w as T,i as z,B as U}from"./libs-qDg_pKW0.js";import{T as S,S as A}from"./index-Blz_3hBI.js";const I=e=>{const[s,n]=N(!1),a=t(()=>{n(!0)}),c=t(()=>{n(!1)});return e=l.cloneElement(e,{onClick:a}),{open:s,trigger:e,onClose:c,onOpen:a}},C=()=>l.useContext(S),D=()=>[l.useRef({closeModal:()=>null,openModal:()=>null}).current],G=e=>{const{event:s}=C(),n=t(e);v(()=>s.on("ok",n)),E(()=>s.off("ok",n))},H=e=>{const{event:s}=C(),n=t(e);v(()=>s.on("cancel",n)),E(()=>s.off("cancel",n))},J=()=>{const{closeModal:e}=C();return[e]},K=e=>{const{modal:s,okText:n,onOpen:a,onClose:c,trigger:r,className:m,rootClassName:p,hasFooter:u=!0,cancelText:f="Back",showCancel:x=!0,...h}=e,{open:i,onClose:M,onOpen:b,trigger:w}=I(r),g=l.useMemo(()=>new F,[]),k=t((d,L)=>g.listeners(d).map(B=>B(L))),O=t(async d=>{await Promise.all(k("ok",d))}),y=t(async d=>{await Promise.all(k("cancel",d)),M()});return l.useEffect(()=>{s&&(s.closeModal=M,s.openModal=b)},[s]),P(()=>{i?a==null||a():c==null||c()},[i]),o.jsxs(S.Provider,{value:{event:g,closeModal:M},children:[w,o.jsx(R,{...h,open:i,onCancel:y,rootClassName:T("shopify",p),className:m,footer:u?o.jsxs(l.Fragment,{children:[o.jsx(j,{type:"text",children:f,onClick:y,icon:o.jsx(z,{}),className:x?"":"visb-hide"}),o.jsx(j,{type:"primary",children:n,onClick:O})]}):null})]})},j=e=>{const{icon:s,loading:n,className:a,children:c,onClick:r,...m}=e,[p,u]=N(n),f=n||p,x=t(async h=>{if(!n){u(!0);try{await(r==null?void 0:r(h))}catch(i){console.error(i)}finally{u(!1)}}});return o.jsx(U,{...m,onClick:x,icon:f?o.jsx(A,{size:20,color:"#aaa"}):s,className:T("shopify",a,f&&"ant-btn-loading"),children:o.jsx("span",{className:"ant-btn-children",children:c})})};export{j as S,K as T,D as a,J as b,H as c,I as d,G as u};
