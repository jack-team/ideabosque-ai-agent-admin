import{w as f,A as k,f as p,b as z,j as e,W as m,x,G as h,y as B,v as P,P as A,S as y,J as S,L as D,B as I}from"./libs-DXEQ_ZwD.js";import"./index-B2INkWq7.js";import{T as w}from"./index-E9LQxVti.js";import{f as g}from"./index-BD-OtoqS.js";import{I as j}from"./index-C950tjKn.js";import{b as T,u as b}from"./hooks-eo-goDbi.js";import{a as F,b as N,c as v}from"./wizard-OmUDIayW.js";import{l as C}from"./useFetchData-LVV7LNzZ.js";import{W as E}from"./map-BPCwAIgA.js";import"./index-C_T-ykei.js";import"./generate-CzU75S6M.js";import"./workflow-ByJLFk5L.js";import"./enum-Ct7sVdAK.js";const W=r=>{if(!r)return;const{elements:s,...i}=r,o=s.map(n=>n.element_uuid);return{...i,elementUuids:o}},L=r=>({...r,updatedBy:"Admin"}),U=r=>{const{formData:s}=r,[i]=f.useForm(),{message:o}=k.useApp(),[n]=T(),l=C(),a=p(()=>{i.setFieldsValue(W(s))});return z.useEffect(()=>{s&&a()},[s]),b(async()=>{var d;const t=await i.validateFields(),c=L(t);try{await F(c),n(),(d=r.onSuccess)==null||d.call(r),o.success(`UI Block ${s?"updated":"created"} successfully.`)}catch{o.error(`Failed to ${s?"update":"create"} UI Block.`)}}),e.jsxs(f,{form:i,submitter:!1,style:{padding:"24px 0 0 0"},children:[e.jsx(m,{hidden:!0,name:"wizardUuid"}),e.jsx(m,{label:"UI Block name",name:"wizardTitle",rules:[{required:!0}]}),e.jsx(x,{label:"UI Block Type",name:"wizardType",valueEnum:E,rules:[{required:!0}]}),e.jsx(h,{label:"UI Block description",name:"wizardDescription",fieldProps:{rows:8},rules:[{required:!0}]}),e.jsx(m,{label:"Priority",name:"priority",fieldProps:{type:"number"},rules:[{required:!0}]}),e.jsx(x,{label:"Elements",name:"elementUuids",mode:"multiple",options:l.options,fieldProps:{maxTagCount:1,loading:l.loading}}),e.jsx(h,{label:"Form Schema",name:"formSchema",fieldProps:{rows:8}})]})},Y=()=>{const{modal:r,message:s}=k.useApp(),i=B(),o=z.useRef(null),n=p(()=>{var a;(a=o.current)==null||a.reload()}),l=p(a=>{r.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify"},onOk:async()=>{try{await N({wizardUuid:a.wizardUuid}),n(),s.success("Deletion successful.")}catch(t){return s.success("Deletion failed."),Promise.reject(t)}}})});return e.jsx(P,{title:"UI Blocks",onBack:()=>i(-1),extra:e.jsxs(y,{size:16,children:[e.jsx(I,{className:"shopify gray",onClick:()=>i("/elements"),children:"Elements"}),e.jsx(w,{width:600,className:"shopify",title:"Create new UI Block",trigger:e.jsx(I,{className:"shopify",type:"primary",children:"Create new UI Block"}),children:e.jsx(U,{})})]}),children:e.jsx(A,{actionRef:o,search:!1,options:!1,scroll:{x:"max-content"},rowKey:"wizardUuid",className:"shopify",request:async a=>{const{current:t,pageSize:c,...d}=a,{wizardList:u}=await v({limit:c,pageNumber:t,...d});return{total:u.total,data:u.wizardList}},columns:[{title:"UI Block Name",dataIndex:"wizardTitle"},{title:"UI Block UUID",dataIndex:"wizardUuid",hideInSearch:!0},{title:"Priority",dataIndex:"priority",hideInSearch:!0},{title:"Create at",dataIndex:"createdAt",hideInSearch:!0,render:(a,t)=>g(t.createdAt)},{title:"Last updated",dataIndex:"updatedAt",hideInSearch:!0,render:(a,t)=>g(t.updatedAt)},{width:"120px",key:"action",title:"Action",align:"center",fixed:"right",hideInSearch:!0,render:(a,t)=>e.jsxs(y,{children:[e.jsx(w,{width:600,destroyOnHidden:!0,className:"shopify",title:"UI Block  Details",trigger:e.jsx(j,{icon:S}),children:e.jsx(U,{formData:t,onSuccess:n})}),e.jsx(j,{icon:D,onClick:()=>l(t)})]})}]})})};export{Y as default};
