import{y as p,A as S,b as v,j as e,W as u,K as j,n as M,o as h,w as g,f,x as b,P as A,i as x,S as I,L as P,D as _}from"./libs-BaOSQqCJ.js";import{I as y}from"./index-CjwgjA-6.js";import"./index-BO1sSPnO.js";import{b as D,u as w}from"./hooks-BBYTyBeI.js";import{c as L,e as T}from"./workflow-4PO1pJly.js";import{T as q}from"./index-CBVePskl.js";import{S as B}from"./index-s4o2-lRw.js";import"./generate-DRufkOf2.js";const F=i=>{const{tools:a,headers:s,...n}=i,o=Object.keys(s).reduce((d,r)=>[...d,{key:r,value:s[r]}],[]);return{...n,headers:o}},k=i=>{const{headers:a,...s}=i,n=a.reduce((o,d)=>({...o,[d.key]:d.value}),{});return{...s,headers:n,updatedBy:"admin"}},H="_edit_form_18m45_1",N={edit_form:H},U=i=>{const{formData:a,onSuccess:s}=i,[n]=p.useForm(),{message:o}=S.useApp(),[d]=D(),r=v.useMemo(()=>{if(a)return F(a)},[a]);return w(async()=>{const t=await n.validateFields(),l=k(t);try{await L(l),d(),s==null||s(),o.success(`Successfully ${a?"updated":"created"} Mcp server.`)}catch(c){return o.error(c.message),Promise.reject(c)}}),e.jsxs(p,{form:n,submitter:!1,scrollToFirstError:!0,initialValues:r,className:N.edit_form,children:[e.jsx(u,{hidden:!0,name:"mcpServerUuid"}),e.jsx(u,{label:"Mcp label",name:"mcpLabel",rules:[{required:!0}]}),e.jsx(u,{name:"mcpServerUrl",label:"Mcp server url",rules:[{required:!0,type:"url"}]}),e.jsx(j,{required:!0,label:"Headers",name:"headers",initialValue:[{}],alwaysShowItemLabel:!0,className:"custom_form_list",creatorButtonProps:{creatorButtonText:"Add Header"},rules:[{validator:(t,l=[],c)=>{if(!l.length){c("Please add Header");return}c()}}],children:e.jsxs(M,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(u,{required:!0,label:"Key",name:"key",rules:[{required:!0}]})}),e.jsx(h,{span:12,children:e.jsx(u,{required:!0,label:"Value",name:"value",rules:[{required:!0}]})})]})})]})},W=()=>{const{modal:i}=S.useApp(),a=v.useRef(null),s=g(),n=f(()=>{var r;(r=a.current)==null||r.reload()}),o=(r,t)=>e.jsx(q,{width:620,destroyOnHidden:!0,trigger:r,title:`${t?"Edit":"Add"} Mcp server`,children:e.jsx(U,{formData:t,onSuccess:n})}),d=f(r=>{i.confirm({title:"Are you sure you want to delete the component?",okText:"Delete",cancelButtonProps:{className:"shopify gray"},okButtonProps:{className:"shopify",danger:!0},onOk:async()=>{}})});return e.jsx(b,{className:"shopify",title:"Mcp Servers",onBack:()=>s(-1),extra:o(e.jsx(B,{type:"primary",children:"Add Mcp Server"})),children:e.jsx(A,{className:"shopify",actionRef:a,rowKey:"mcpServerUuid",options:!1,search:!1,pagination:{defaultPageSize:5},columns:[{dataIndex:"mcpLabel",title:"Mcp label"},{dataIndex:"mcpServerUrl",title:"Mcp Server Url",hideInSearch:!0},{dataIndex:"createdAt",title:"Created At",hideInSearch:!0,render:(r,t)=>x(t.createdAt).format("YYYY/MM/DD HH:mm:ss")},{dataIndex:"updatedAt",title:"Updated at",hideInSearch:!0,render:(r,t)=>x(t.updatedAt).format("YYYY/MM/DD HH:mm:ss")},{dataIndex:"updatedBy",title:"Updated by",hideInSearch:!0},{key:"action",title:"Action",width:"100px",align:"center",hideInSearch:!0,fixed:"right",render:(r,t)=>e.jsxs(I,{children:[o(e.jsx(y,{icon:_}),t),e.jsx(y,{icon:P,onClick:()=>d(t)})]})}],scroll:{x:"max-content"},request:async r=>{const{current:t=1,pageSize:l=10,...c}=r,{mcpServerList:m}=await T({pageNumber:t,limit:l,...c});return{total:m.total,data:m.mcpServerList}}})})};export{W as default};
