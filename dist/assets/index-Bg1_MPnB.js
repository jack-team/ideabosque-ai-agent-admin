import{b as u,u as x,x as H,y as U,z as W,D as Ee,F as Z,o as J,j as t,S as ke,G as $e,H as De,J as Pe,K as We,Q,U as ee,W as b,p as R,v as F,V as te,X as Re,Y as ne,w as V,f as O,g as C,Z as qe,_ as Ae,$ as Me,a0 as He,a1 as Le,a2 as Be,a3 as Ue,a4 as Ve,a5 as Oe,a6 as se,a7 as Xe,a8 as Ye,a9 as ze,aa as Je,ab as Ge,ac as Ke,ad as Ze,M as Qe,ae as oe,m as X,af as et,ag as tt,h as nt,A as st,t as ot,ah as rt,n as at}from"./libs-Clw9C49h.js";import{k as ct,j as lt}from"./workflow-DhBfg7d4.js";import{c as G}from"./index-CyTaOGOS.js";import{T as it,u as dt}from"./index-g0lC1wlR.js";import{S as ut}from"./index-D3QcqB_5.js";import{b as mt,u as pt}from"./hooks-V0qdfiJ4.js";import{S as re}from"./index-DxFRfNm6.js";import{S as ht}from"./index-BYxCPemj.js";import"./request-BPdAPW8d.js";import"./generate-C1aCBGPy.js";function ae(e){return[u.useRef(e).current]}function ce(e,n){const s=n(),o=x(()=>{!e||!s||Object.keys(s).forEach(r=>{e[r]=s[r]})});u.useEffect(o,[s,o])}const le="default_source_handle",Y="default_target_handle",L="start-id",xt={id:L,type:"start",data:{formData:{}},position:{x:0,y:0}},ie=e=>{const n=new Map;for(const s of e){const o=s.source,r=n.get(o)||[];n.set(o,[...r,s])}return n},ft=(e,n="")=>({id:H(),source:e,target:n,sourceHandle:le,targetHandle:Y}),_t=e=>{const n=[];for(const s of e){n.push(s);const o=s.target;e.find(r=>r.source===o)||n.push(ft(o))}return n};function gt(e){e=_t(e);const n=e.find(c=>c.source===L);if(!n)return e;const s=ie(e),o=[n];let r=n.target;const a=c=>s.get(c)||[];for(;a(r).length;){const[c]=a(r);o.push(c),r=c.target;const l=a(r).filter(i=>i.id!==c.id);s.set(r,l)}for(const c of e)o.some(l=>l.id===c.id)||o.push(c);return o.filter(c=>c.source!==L)}const jt=e=>[...ie(e)].map(([n,s])=>{const[o]=s,r=o.target,a=s.length>1?s:[],c={id:n},l=a.map(i=>({condition:i.sourceHandle,nextStep:i.target}));return l.length&&(c.conditions=l),a.length||(c.nextStep=r),c});function z(e){const n=new Map,s=e.nodes||[],o=e.edges||[];for(const l of s)n.set(l.id,l);const r=gt(o),a=jt(r),c=l=>n.get(l);return a.map(l=>{const i=c(l.id),d=i==null?void 0:i.data,{branch:m,...f}={...d==null?void 0:d.formData},p={...l,type:i==null?void 0:i.type,formData:f};return m!=null&&m.length&&(p.conditions=m.map(h=>({condition:h.value,nextStep:""}))),d!=null&&d.details&&(p.details=z(d==null?void 0:d.details)),p})}const bt=e=>{const n=new Set;let s=z(e);return s=s.filter(o=>!o.nextStep),s.forEach(o=>{const r=o.conditions;if(!(r!=null&&r.length))n.add("off topic");else for(const a of r)n.add(a.condition)}),[...n].map(o=>({label:o,value:o}))},de=u.createContext({}),ue=u.createContext({}),yt=()=>ae({getData:()=>null}),me=()=>ae({getData:()=>null}),g=()=>u.useContext(de),pe=()=>u.useContext(ue),he=()=>{const e=U(),{openDetail:n}=g(),{addEdges:s,addNodes:o,getNodes:r}=W(),a=x(()=>{var f;const i=r().find(p=>p.id===e);let d=(i==null?void 0:i.position.x)||0;const m=(i==null?void 0:i.position.y)||0;return d=d+(((f=i==null?void 0:i.measured)==null?void 0:f.width)||0)+80,{x:d,y:m}});return[x(l=>{const i=H(),d=l.triggerId,m=l.nodeType;o({id:i,data:l,type:m,position:a()}),e&&s({id:H(),source:e,target:i,sourceHandle:d,targetHandle:Y}),m==="step"&&n(i)})]},Nt=()=>{const{detailId:e}=g();return Z().find(s=>s.id===e)},vt=()=>{const e=Nt();return e==null?void 0:e.data};function wt(){const e=U(),n=Ee(e);return n==null?void 0:n.data}function v(){const e=wt();return e==null?void 0:e.formData}const Ct="_form_svv3s_1",Ft={form:Ct},St=e=>{var r;const{onSubmit:n}=e,[s]=mt(),[o]=J.useForm();return pt(async()=>{const a=await(o==null?void 0:o.validateFields());a&&await n(a),s()}),t.jsx(J,{form:o,submitter:!1,className:Ft.form,initialValues:e.formData,children:(r=e.children)==null?void 0:r.call(e,o)})},xe=e=>{const{children:n,onSubmit:s,formData:o,...r}=e;return t.jsx(it,{...r,children:t.jsx(St,{formData:o,onSubmit:s,children:n})})},It="_wrapper_fmhpg_4",Tt="_tools_fmhpg_4",Et="_tool_item_fmhpg_15",kt="_inner_fmhpg_26",$t="_content_fmhpg_34",Dt="_handle_fmhpg_38",Pt="_handle_source_fmhpg_39",Wt="_branch_fmhpg_59",Rt="_branch_item_fmhpg_63",qt="_branch_label_fmhpg_71",_={wrapper:It,tools:Tt,tool_item:Et,inner:kt,content:$t,handle:Dt,handle_source:Pt,branch:Wt,branch_item:Rt,branch_label:qt},At=e=>{const{nodeId:n,tools:s}=e,{editForm:o}=s,{top:r}=pe(),{openDetail:a}=g(),{setNodes:c,updateNodeData:l}=W(),i=v(),d=x(()=>{c(h=>h.filter(j=>j.id!==n))}),m=x(async h=>{l(n,{formData:h})}),f=x(()=>{a(n)}),p=h=>o?t.jsx(xe,{centered:!0,okText:"Save",destroyOnHidden:!0,trigger:h,formData:i,width:o.width,onSubmit:m,title:o.title||"Edit Node",children:j=>t.jsx(o.Component,{form:j})}):null;return t.jsxs(ke,{size:16,children:[r&&t.jsx("div",{onClick:f,className:_.tool_item,children:t.jsx($e,{})}),p(t.jsx("div",{className:_.tool_item,children:t.jsx(Pe,{})})),t.jsx("div",{onClick:d,className:_.tool_item,children:t.jsx(De,{})})]})},Mt="_atom_node_fh105_1",Ht="_atom_icon_fh105_11",Lt="_atom_content_fh105_21",Bt="_atom_title_fh105_24",Ut="_atom_desc_fh105_30",I={atom_node:Mt,atom_icon:Ht,atom_content:Lt,atom_title:Bt,atom_desc:Ut},K=e=>{const{Icon:n,...s}=e;return t.jsxs("div",{onClick:e.onClick,className:I.atom_node,children:[t.jsx("div",{className:I.atom_icon,children:t.jsx(n,{})}),t.jsxs("div",{className:I.atom_content,children:[t.jsx("div",{className:I.atom_title,children:s.title}),t.jsx("div",{className:I.atom_desc,children:s.desc})]})]})},Vt=e=>{const{triggerId:n,onChange:s,closeDrawer:o}=e,r=Z(),{top:a}=pe();return t.jsx(u.Fragment,{children:Ce.filter(c=>c.limit!==void 0?r.filter(i=>i.type===c.type).length<c.limit:a?c.top:!c.top).map(c=>{const{type:l,Component:i,...d}=c,m=i.Icon,f=i.Form,p=async(h={})=>{o(),s==null||s({nodeType:l,triggerId:n,formData:h})};return f?t.jsx(xe,{centered:!0,okText:"Add Node",onSubmit:p,width:i.modalWdith,title:`Add ${d.title} Node`,children:h=>t.jsx(f,{form:h}),trigger:t.jsx(K,{...d,Icon:m})},l):u.createElement(K,{...d,Icon:m,key:l,onClick:p})})})},fe=e=>{const{children:n,...s}=e,{open:o,trigger:r,onClose:a}=dt(n);return t.jsxs(t.Fragment,{children:[r,t.jsx(We,{open:o,destroyOnHidden:!0,onClose:a,rootClassName:"shopify",title:"What triggers this workflow?",children:t.jsx(Vt,{...s,closeDrawer:a})})]})},Ot=e=>{const{branch:n=[]}=e,s=o=>t.jsx(fe,{triggerId:o,onChange:e.onChange,children:t.jsx(Q,{id:o,type:"source",position:ee.Right,className:_.handle_source})});return n.length?t.jsx("div",{className:_.branch,children:n.map(o=>t.jsxs("div",{className:_.branch_item,children:[t.jsx("div",{className:_.branch_label,children:o.label}),s(o.value)]},o.value))}):s(le)},w=e=>{const{tools:n,branch:s=[],enableHandle:o}=e,{source:r=!0,target:a=!0}=o||{},c=U(),[l]=he();return t.jsxs("div",{className:_.wrapper,children:[t.jsx("div",{className:_.tools,children:!!n&&c&&t.jsx(At,{nodeId:c,tools:n})}),t.jsxs("div",{className:_.inner,children:[a&&t.jsx(Q,{type:"target",id:Y,position:ee.Left,className:_.handle,isConnectableStart:!1}),t.jsx("div",{className:_.content,children:e.children}),r&&t.jsx(Ot,{branch:s,onChange:l})]})]})},Xt="_title_1tfkx_1",Yt="_description_1tfkx_6",A={title:Xt,description:Yt},S=e=>t.jsxs("div",{className:A.node_desc,children:[t.jsx("div",{className:A.title,children:e.title}),t.jsx("div",{className:A.description,children:e.desc})]}),zt=e=>{const{inputParams:n=[]}=e;return n.map(s=>{const o=s.options,r={label:s.label,name:s.name,disabled:s.disabled,readonly:s.readonly,initialValue:s.initialValue,rules:[{required:s.required}]};return t.jsx(u.Fragment,{children:o!=null&&o.length?t.jsx(R,{...r,options:o}):t.jsx(b,{...r})},s.name)})},_e=()=>{const{uiComponents:e=[]}=g(),n=e.map(s=>({label:s.componentName,value:s.componentTag}));return t.jsxs(u.Fragment,{children:[t.jsx(R,{label:"Component",name:"name",options:n,rules:[{required:!0}]}),t.jsx(F,{label:"Text",name:"text",rules:[{required:!0}]}),t.jsx(te,{name:["name"],children:({name:s})=>{const o=e.find(r=>r.componentTag===s);return t.jsx(zt,{inputParams:o==null?void 0:o.input})}})]})},T=()=>{const e=v(),{uiComponents:n=[]}=g(),s=n.find(o=>o.componentTag===(e==null?void 0:e.name));return t.jsx(w,{tools:{editForm:{Component:_e,title:"Edit Ui node",width:T.modalWdith}},children:t.jsx(S,{title:s==null?void 0:s.componentName,desc:e==null?void 0:e.text})})};T.Form=_e;T.modalWdith=400;T.Icon=Re;const Jt="_container_12b9h_1",Gt="_icon_12b9h_7",Kt="_text_12b9h_12",M={container:Jt,icon:Gt,text:Kt},ge=()=>t.jsx(w,{enableHandle:{target:!1},children:t.jsxs("div",{className:M.container,children:[t.jsx("div",{className:M.icon,children:t.jsx(ne,{})}),t.jsx("div",{className:M.text,children:"Start"})]})});ge.Icon=ne;const je=()=>t.jsxs(u.Fragment,{children:[t.jsx(b,{name:"name",label:"Name",rules:[{required:!0}]}),t.jsx(F,{label:"Text",name:"text",rules:[{required:!1}]}),t.jsx(V,{label:"Condition",name:"branch",children:t.jsxs(O,{gutter:16,children:[t.jsx(C,{span:12,children:t.jsx(b,{label:"Label",name:"label",rules:[{required:!0}]})}),t.jsx(C,{span:12,children:t.jsx(b,{label:"Value",name:"value",rules:[{required:!0}]})})]})})]}),E=()=>{const e=v();return t.jsx(w,{branch:e==null?void 0:e.branch,tools:{editForm:{width:E.modalWdith,title:"Edit Branch node",Component:je}},children:t.jsx(S,{title:e==null?void 0:e.name,desc:e==null?void 0:e.text})})};E.Form=je;E.modalWdith=400;E.Icon=qe;var be=(e=>(e.Prompt="prompt",e.Text="text",e))(be||{});const B={prompt:"Prompt",text:"Text"},ye=()=>t.jsxs(u.Fragment,{children:[t.jsx(Ae.Group,{label:"Type",name:"type",initialValue:be.Prompt,valueEnum:B,rules:[{required:!0}]}),t.jsx(te,{name:["type"],children:({type:e})=>e?t.jsx(F,{label:B[e],name:"text",rules:[{required:!0}]}):null})]}),k=()=>{const e=v(),n=e==null?void 0:e.type;return t.jsx(w,{tools:{editForm:{width:k.modalWdith,title:"Edit Prompt node",Component:ye}},children:t.jsx(S,{title:n&&B[n],desc:e==null?void 0:e.text})})};k.Form=ye;k.modalWdith=360;k.Icon=Me;const Ne=()=>{const{actions:e=[]}=g(),n=u.useMemo(()=>e.map(s=>({value:s.name,label:s.description})),[e]);return t.jsxs(u.Fragment,{children:[t.jsx(R,{label:"Action",name:"type",options:n,rules:[{required:!0}]}),t.jsx(F,{label:"Text",name:"text",rules:[{required:!1}]})]})},$=()=>{const{actions:e=[]}=g(),n=v(),s=u.useMemo(()=>e.find(o=>(n==null?void 0:n.type)===o.name),[e,n==null?void 0:n.type]);return t.jsx(w,{tools:{editForm:{Component:Ne,title:"Edit Action node",width:$.modalWdith}},children:t.jsx(S,{title:s==null?void 0:s.name,desc:n==null?void 0:n.text})})};$.Form=Ne;$.modalWdith=400;$.Icon=He;const ve=()=>{const{transformTools:e=[]}=g();return t.jsxs(u.Fragment,{children:[t.jsx(R,{options:e,label:"Type",name:"type",rules:[{required:!0}]}),t.jsx(F,{label:"Text",name:"text",rules:[{required:!0}]}),t.jsx(V,{name:"attrs",label:"Attributes",creatorButtonProps:{creatorButtonText:"Add Attribute"},children:t.jsxs(O,{gutter:16,children:[t.jsx(C,{span:12,children:t.jsx(b,{label:"From",name:"from",rules:[{required:!0}]})}),t.jsx(C,{span:12,children:t.jsx(b,{label:"To",name:"to",rules:[{required:!0}]})})]})})]})},D=()=>{const{transformTools:e=[]}=g(),n=v(),s=u.useMemo(()=>e.find(o=>o.value===(n==null?void 0:n.type)),[e,n==null?void 0:n.type]);return t.jsx(w,{tools:{editForm:{width:D.modalWdith,title:"Edit Transform node",Component:ve}},children:t.jsx(S,{title:s==null?void 0:s.label,desc:n==null?void 0:n.text})})};D.Form=ve;D.modalWdith=450;D.Icon=Le;const we=()=>t.jsxs(u.Fragment,{children:[t.jsx(b,{label:"Name",name:"name",rules:[{required:!0}]}),t.jsx(F,{label:"Description",name:"description",rules:[{required:!1}]}),t.jsx(V,{label:"Condition",name:"branch",children:t.jsxs(O,{gutter:16,children:[t.jsx(C,{span:12,children:t.jsx(b,{label:"Label",name:"label",rules:[{required:!0}]})}),t.jsx(C,{span:12,children:t.jsx(b,{label:"Value",name:"value",rules:[{required:!0}]})})]})})]}),P=()=>{const e=v();return t.jsx(w,{branch:e==null?void 0:e.branch,tools:{editForm:{Component:we,title:"Edit Step node",width:P.modalWdith}},children:t.jsx(S,{title:e==null?void 0:e.name,desc:e==null?void 0:e.description})})};P.Form=we;P.modalWdith=380;P.Icon=Be;const Ce=[{limit:1,top:!0,type:"start",title:"Start",desc:"The starting node of a workflow.",Component:ge},{top:!0,type:"step",title:"Step",desc:"Execute the corresponding process according to the different branches created.",Component:P},{type:"ui",title:"UI",desc:"The UI components within the AI assistant can be used as a data source to obtain data.",Component:T},{type:"branch",title:"Branch",desc:"Execute the corresponding process according to the different branches created.",Component:E},{type:"prompt",title:"Prompt",desc:"Prompt the AI what to do or say.",Component:k},{type:"action",title:"Action",desc:"Execute the corresponding process according to the different branches created.",Component:$},{type:"transform",title:"Transform",desc:"Convert the input data.",Component:D}],Zt=e=>{const{stroke:n}=e;return t.jsx("defs",{children:t.jsx("marker",{id:e.id,refX:"0",refY:"0",markerWidth:"12.5",markerHeight:"12.5",viewBox:"-10 -10 20 20",markerUnits:"strokeWidth",orient:"auto-start-reverse",style:{stroke:n,fill:n,strokeWidth:1},children:t.jsx("polyline",{strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})})})},Qt="_del_btn_7471i_1",en={del_btn:Qt},tn=e=>{const{id:n,selected:s,sourceX:o,sourceY:r,targetX:a,targetY:c,sourcePosition:l,targetPosition:i}=e,{setEdges:d}=W(),[m,f,p]=Ue({sourceX:o,sourceY:r,targetX:a,targetY:c}),h=u.useMemo(()=>`translate(-50%, -50%) 
      translate(${f}px,${p}px)`,[f,p]),j=s?"#f40":"#0143EC",y=x(()=>{d(q=>q.filter(Te=>Te.id!==n))});return t.jsxs(u.Fragment,{children:[t.jsx(Zt,{stroke:j,id:n}),t.jsx(Ve,{sourceX:o,sourceY:r,targetX:a,targetY:c,markerEnd:`url(#${n})`,sourcePosition:l,targetPosition:i,style:{stroke:j,strokeWidth:2}}),t.jsx(Oe,{children:s?t.jsx("div",{style:{transform:h},onClick:y,className:en.del_btn,children:t.jsx(se,{})}):null})]})},nn={"step-edge":tn},sn="_add_button_1ocve_1",on={add_button:sn},rn=()=>{const[e]=he();return t.jsx(fe,{onChange:e,children:t.jsx("div",{className:on.add_button,children:t.jsx(Xe,{})})})},an=e=>{const{fromX:n,fromY:s,toX:o,toY:r}=e,a=(n+o)/2,c=`M${n},${s} H${a} V${r} H${o}`;return t.jsxs("g",{children:[t.jsx("path",{fill:"none",stroke:"#0143EC",strokeWidth:2,className:"animated",d:c}),t.jsx("circle",{cx:o,cy:r,fill:"#fff",r:3,stroke:"#0143EC",strokeWidth:2})]})},cn=Ce.reduce((e,n)=>({...e,[n.type]:n.Component}),{}),Fe=e=>{const{canvas:n,top:s=!0,defaultNodes:o=[],defaultEdges:r=[]}=e,a=u.useMemo(()=>o.length?o:[G(xt)],[o]),[c,l,i]=Ye(r),[d,m,f]=ze(a),p=c.map(y=>({...y,type:"step-edge"})),h=x(y=>l(q=>Je(y,q))),j=x(()=>G({edges:c,nodes:d,_v_:1}));return ce(n,()=>({getData:j})),t.jsx(ue,{value:{top:s},children:t.jsxs(Ge,{minZoom:.5,nodes:d,edges:p,edgeTypes:nn,nodeTypes:cn,deleteKeyCode:null,onConnect:h,onNodesChange:f,onEdgesChange:i,connectionLineComponent:an,fitView:!0,children:[t.jsx(Ke,{size:2,color:"#ccc",bgColor:"#f6f6f6"}),t.jsx(Ze,{}),t.jsx(rn,{})]})})},ln="_detail_1hmmw_1",dn="_show_1hmmw_14",un="_layer_1hmmw_19",mn="_layer_content_1hmmw_25",pn="_layer_header_1hmmw_28",hn="_close_btn_1hmmw_33",xn="_title_1hmmw_46",N={detail:ln,show:dn,layer:un,layer_content:mn,layer_header:pn,close_btn:hn,title:xn},fn=()=>{var p;const e=vt(),[n]=me(),{updateNodeData:s}=W(),[o,r]=Qe.useModal(),{closeDetail:a,detailId:c}=g(),l=e==null?void 0:e.details,i=l==null?void 0:l.nodes,d=l==null?void 0:l.edges,m=x(()=>{const h=n.getData(),j=bt(h),y={...e==null?void 0:e.formData,branch:j};s(c,{details:h,formData:y}),a()}),f=x(()=>{o.confirm({title:"Are you sure you want to leave?",content:"The data on this page will be lost after leaving.",okText:"Yes",okButtonProps:{className:"shopify"},cancelButtonProps:{className:"shopify"},onOk:a})});return t.jsxs("div",{className:N.layer,children:[t.jsxs("div",{className:N.layer_header,children:[t.jsx("div",{onClick:f,className:N.close_btn,children:t.jsx(se,{})}),t.jsx("div",{className:N.title,children:(p=e==null?void 0:e.formData)==null?void 0:p.name}),t.jsx(re,{type:"primary",onClick:m,children:"Save"})]}),t.jsx("div",{className:N.layer_content,children:t.jsx(oe,{children:t.jsx(Fe,{top:!1,canvas:n,defaultNodes:i,defaultEdges:d})})}),r]})},_n=()=>{const{detailId:e}=g(),[n,s]=X(!1),o=x(()=>s(!0)),r=x(()=>s(!1));et(()=>{e?o():setTimeout(r,400)},[e]);const a=tt(N.detail,!!e&&N.show);return t.jsx("div",{className:a,children:n&&t.jsx(fn,{})})},gn=e=>{const{children:n,...s}=e,[o,r]=X(),a=x(l=>{r(l)}),c=x(()=>{r(void 0)});return t.jsx(de.Provider,{value:{...s,detailId:o,openDetail:a,closeDetail:c},children:n})},jn=e=>{const[n]=me(),s=x(()=>{const o=n.getData();return{realDetails:o,assembleData:z(o)}});return ce(e.flow,()=>({getData:s})),t.jsx(oe,{children:t.jsxs(gn,{...e,children:[t.jsx(Fe,{...e,canvas:n}),t.jsx(_n,{})]})})},bn=(e={})=>Object.keys(e).reduce((n,s)=>{var r,a;let o=(r=e[s])==null?void 0:r.value;if(s==="conditions"){s="branch";const c=o;o=(a=c==null?void 0:c.map)==null?void 0:a.call(c,l=>({label:l.condition,value:l.condition}))}return{...n,[s]:o}},{}),Se=e=>{if(e!=null&&e._v_)return e;let n=(e==null?void 0:e.nodes)||[];return n=n.map(s=>{var r;const o=(r=s==null?void 0:s.data)==null?void 0:r.values;return{...s,data:{nodeType:o==null?void 0:o.nodeType,formData:bn(o==null?void 0:o.formData),details:Se(o==null?void 0:o.stepRealData)}}}),{...e,nodes:n}},yn=e=>e.map(n=>({componentName:n.tag_name,componentTag:n.tag_name,componentId:n.ui_component_uuid,componentType:n.ui_component_type,input:n.parameters.map(s=>{let o=s.parameter;return o&&(o=`{${o}}`),{required:!0,label:s.name,name:s.name,initialValue:o}})})),Nn=e=>e.reduce((s,o)=>[...s,...o.tools],[]).map(s=>({name:s.name,description:s.description})),vn=()=>[{label:"Summarize",value:"summarize"},{label:"Full content",value:"full_content"},{label:"Structure input",value:"structure_input"}],wn="_loading_1cv3a_1",Cn="_container_1cv3a_7",Ie={loading:wn,container:Cn},Fn=e=>{const{promptTemplate:n,flowRelationship:s}=e.detail,o=Nn(n.mcp_servers),r=vn(),a=yn(n.ui_components),c=u.useMemo(()=>{const l=s?JSON.parse(s):{};return Se(l)},[s,a]);return t.jsx(nt,{className:"shopify full-content",children:t.jsx("div",{className:Ie.container,children:t.jsx(jn,{flow:e.flow,actions:o,uiComponents:a,transformTools:r,defaultEdges:c.edges,defaultNodes:c.nodes})})})};function qn(){var i;const{message:e}=st.useApp(),[n]=yt(),s=ot(),[o,r]=X(!1),{data:a}=rt(async()=>(await ct({flowSnippetUuid:s.uid,flowSnippetVersionUuid:s.vid})).flowSnippet),c=(i=a==null?void 0:a.promptTemplate)==null?void 0:i.prompt_uuid,l=x(async()=>{const d=n.getData();r(!0),await lt({...a,promptUuid:c,flowContext:JSON.stringify(d.assembleData),flowRelationship:JSON.stringify(d.realDetails)}),e.success("Workflow saved successfully"),r(!1)});return t.jsx(at,{title:a==null?void 0:a.flowName,className:"shopify full-screen",loading:!a&&t.jsx("div",{className:Ie.loading,children:t.jsx(ut,{size:36})}),extra:a?t.jsx(re,{type:"primary",className:"shopify",onClick:l,children:"Save"}):null,children:t.jsx(ht,{loading:o,children:!!a&&t.jsx(Fn,{flow:n,detail:a})})})}export{qn as default};
