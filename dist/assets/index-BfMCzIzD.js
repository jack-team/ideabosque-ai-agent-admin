import{y as x,A as G,f as p,b,j as e,W as u,J as A,z as C,K as Q,n as w,o as h,x as D,P as F,S as v,D as I,L as N,B as P}from"./libs-BF3diSH3.js";import{b as m,f as y}from"./index-C5iRsA-N.js";import{T as g}from"./index-D58RYOl7.js";import{I as q}from"./index-B8iVvICq.js";import{b as S,u as M}from"./hooks-pwUMIFZ8.js";import{a as f}from"./generate-uIsxLL3f.js";import{R as U}from"./map-BPCwAIgA.js";import"./index-BCRILwkD.js";import"./enum-Ct7sVdAK.js";const k=r=>{if(!r)return;let{questionCriteria:t,...o}=r;const i={...t};return{...o,questionCriteria:Object.keys(i).map(n=>({attribute:n,value:i[n]}))}},R=r=>{const{questionCriteria:t,...o}=r,n=t.reduce((a,s)=>({...a,[s.attribute]:s.value}),{});return{...o,questionCriteria:n,updatedBy:"Admin"}},T=async r=>{const t=await f({type:"Query",name:"questionGroupList"});return m.graphql({query:t,variables:r})},E=async r=>{const t=await f({type:"Mutation",name:"insertUpdateQuestionGroup"});return m.graphql({query:t,variables:r})},L=async r=>{const t=await f({type:"Mutation",name:"deleteQuestionGroup"});return m.graphql({query:t,variables:r})},j=r=>{const{formData:t}=r,[o]=x.useForm(),{message:i}=G.useApp(),[n]=S(),a=p(()=>{o.setFieldsValue(k(t))});return b.useEffect(()=>{t&&a()},[t]),M(async()=>{var l;const s=await o.validateFields(),c=R(s);try{await E(c),n(),(l=r.onSuccess)==null||l.call(r),i.success(`Question Group ${t?"updated":"created"} successfully.`)}catch{i.error(`Failed to ${t?"updated":"created"} Question Group.`)}}),e.jsxs(x,{form:o,submitter:!1,style:{padding:"24px 0 0 0"},children:[e.jsx(u,{hidden:!0,name:"questionGroupUuid"}),e.jsx(u,{label:"Question Group Name",name:"questionGroupName",rules:[{required:!0}]}),e.jsx(A,{label:"Question Group Description",name:"questionGroupDescription",rules:[{required:!0}]}),e.jsx(u,{label:"Weight",name:"weight",rules:[{required:!0}]}),e.jsx(C,{label:"Region",name:"region",valueEnum:U,rules:[{required:!0}]}),e.jsx(Q,{label:"Question Criteria",name:"questionCriteria",className:"custom_form_list",children:e.jsxs(w,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(u,{label:"Attribute",name:"attribute",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})}),e.jsx(h,{span:12,children:e.jsx(u,{label:"Value",name:"value",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})})]})})]})},J=()=>{const{modal:r,message:t}=G.useApp(),o=b.useRef(null),i=p(()=>{var a;(a=o.current)==null||a.reload()}),n=p(a=>{r.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify gray"},onOk:async()=>{try{await L({questionGroupUuid:a.questionGroupUuid}),i(),t.success("Deletion successful.")}catch(s){return t.success("Deletion failed."),Promise.reject(s)}}})});return e.jsx(D,{title:"Question Groups",extra:e.jsx(g,{width:600,className:"shopify",title:"Create Question Group",trigger:e.jsx(P,{className:"shopify",type:"primary",children:"Create Question group"}),children:e.jsx(j,{onSuccess:i})}),children:e.jsx(F,{actionRef:o,search:!1,options:!1,rowKey:"questionGroupUuid",className:"shopify",request:async a=>{const{current:s,pageSize:c,...l}=a,{questionGroupList:d}=await T({limit:c,pageNumber:s,...l});return{total:d.total,data:d.questionGroupList}},columns:[{title:"Question Group UUID",dataIndex:"questionGroupUuid"},{title:"Question Group Name",dataIndex:"questionGroupName"},{title:"Create at",dataIndex:"createdAt",hideInSearch:!0,render:(a,s)=>y(s.createdAt)},{title:"Update at",dataIndex:"updatedAt",hideInSearch:!0,render:(a,s)=>y(s.updatedAt)},{width:"120px",key:"action",title:"Action",align:"center",hideInSearch:!0,render:(a,s)=>e.jsxs(v,{children:[e.jsx(g,{width:620,destroyOnHidden:!0,className:"shopify",title:"Edit Question Groups",trigger:e.jsx(q,{icon:I}),children:e.jsx(j,{formData:s,onSuccess:i})}),e.jsx(q,{icon:N,onClick:()=>n(s)})]})}]})})};export{J as default};
