import{o as j,A as F,s as k,t as q,m as _,u as f,b as N,j as e,n as A,h as U,W as l,f as y,g as o,p as x,v as S,w as L,S as V}from"./libs-C65raxhD.js";import{f as W,i as E}from"./workflow-Cw9nkl8g.js";import{u as M,a as B}from"./useFetchData-SdPGuxol.js";import{S as R}from"./index-tMld6ZHS.js";import"./index-CFiK8WbN.js";import{S as z}from"./index-BmuJcdsb.js";import{a as O}from"./const-DP1vyTQS.js";import"./request-DncSvQ2C.js";const g="__",G=s=>{const a=s.mcpServers.map(r=>r.mcp_server_uuid),n=s.uiComponents.map(r=>[r.ui_component_uuid,r.ui_component_type].join(g));return{...s,mcpServers:a,uiComponents:n}},H=s=>{const a=s.mcpServers||[],n=s.uiComponents||[],r=a.map(i=>({mcp_server_uuid:i})),u=n.map(i=>{const[m,c]=i.split(g);return{ui_component_uuid:m,ui_component_type:c}});return{...s,mcpServers:r,uiComponents:u,updatedBy:"admin"}},I="_wrapper_1ekrk_1",J="_form_1ekrk_4",K="_form_list_1ekrk_7",h={wrapper:I,form:J,form_list:K},te=()=>{const[s]=j.useForm(),{message:a}=F.useApp(),{state:n}=k(),{uid:r,vid:u}=q(),[i,m]=_(!1),{options:c,loading:v}=M(),{options:T,loading:b}=B(),[t,C]=_(n),w=f(async()=>{const{promptTemplate:p}=await W({promptUuid:r,promptVersionUuid:u});C(p)}),P=f(()=>{const p=G(t);s.setFieldsValue(p)}),D=f(async()=>{const p=await s.validateFields();try{m(!0);const d=H(p);await E(d),a.success("Template saved successfully.")}catch(d){a.error(d.message)}finally{m(!1)}});return N.useEffect(()=>{t?P():w()},[t]),e.jsx(R,{loading:!t,children:e.jsx(A,{title:t==null?void 0:t.promptName,className:"shopify full-screen",extra:e.jsx(V,{children:e.jsx(z,{type:"primary",loading:i,disabled:!t,onClick:D,children:"Save"})}),children:e.jsx("div",{className:h.wrapper,children:e.jsx(U,{className:"shopify",children:e.jsxs(j,{form:s,submitter:!1,layout:"horizontal",labelAlign:"left",className:h.form,labelCol:{flex:"180px"},children:[e.jsx(l,{hidden:!0,name:"promptUuid"}),e.jsx(l,{hidden:!0,name:"promptVersionUuid"}),e.jsxs(y,{gutter:16,children:[e.jsx(o,{span:24,children:e.jsx(l,{label:"Template Name",name:"promptName",rules:[{required:!0}]})}),e.jsx(o,{span:24,children:e.jsx(x,{label:"Type",name:"promptType",valueEnum:O,rules:[{required:!0}]})}),e.jsx(o,{span:24,children:e.jsx(x,{label:"Mcp Servers",name:"mcpServers",mode:"multiple",options:T,rules:[{required:!0}],fieldProps:{loading:b}})}),e.jsx(o,{span:24,children:e.jsx(x,{label:"Ui Components",name:"uiComponents",mode:"multiple",options:c,rules:[{required:!0}],fieldProps:{loading:v}})})]}),e.jsx(S,{label:"Template Description",name:"promptDescription",fieldProps:{rows:12},rules:[{required:!0}]}),e.jsx(S,{label:"Template Context",name:"templateContext",fieldProps:{rows:12},rules:[{required:!0}]}),e.jsx(L,{label:"Variables",name:"variables",className:h.form_list,children:e.jsxs(y,{gutter:16,children:[e.jsx(o,{span:12,children:e.jsx(l,{name:"name",placeholder:"Variable Name",rules:[{required:!0}]})}),e.jsx(o,{span:12,children:e.jsx(l,{name:"data_type",placeholder:"Data type",rules:[{required:!0}]})})]})})]})})})})})};export{te as default};
