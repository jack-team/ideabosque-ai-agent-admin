import{w as l,A as y,j as o,W as u,G as h,x as C,b as j,f as m,v as A,P as D,S as N,J as P,L as w,B as F}from"./libs-DXEQ_ZwD.js";import"./index-BJeZZQIQ.js";import{T as p}from"./index-B6G6DH-G.js";import{I as f}from"./index-C950tjKn.js";import{f as g}from"./index-BD-OtoqS.js";import{j as S}from"./useFetchData-6schqLKv.js";import{b as I,u as T}from"./hooks-DdWCLLPd.js";import{i as U,d as b,g as _}from"./contactProfiles-DIGJkPam.js";import"./index-BMWCRZZK.js";import"./workflow-Bw04EY5P.js";import"./generate-CKUS3uF_.js";import"./wizard-DsuWhXTr.js";import"./enum-Ct7sVdAK.js";const k=a=>{if(!a)return;const{agents:s=[],...i}=a;return{...i,agents:s.map(n=>n.agent_uuid)}},v=(a,s)=>{const{agents:i=[],...n}=a,r=i.map(t=>{var d;const e=(d=s.find(c=>c.value===t))==null?void 0:d.realData;return{agent_uuid:t,agent_type:"task",agent_name:e==null?void 0:e.agentName,agent_description:e==null?void 0:e.agentDescription}});return{...n,agents:r,updatedBy:"Admin"}},x=a=>{const{formData:s}=a,[i]=l.useForm(),{message:n}=y.useApp(),[r]=I(),t=S();return T(async()=>{var d;const e=await i.validateFields();try{const c=v(e,t.options);await U(c),n.success("Coordination created successfully."),r(),(d=a.onSuccess)==null||d.call(a)}catch{n.error("Failed to create Coordination.")}}),o.jsxs(l,{form:i,submitter:!1,style:{padding:"24px 0 0 0"},initialValues:k(s),children:[o.jsx(u,{name:"coordinationUuid",hidden:!0}),o.jsx(u,{required:!1,label:"Coordination Name",name:"coordinationName",rules:[{required:!0}]}),o.jsx(h,{required:!1,label:"Coordination Description",name:"coordinationDescription",rules:[{required:!0}]}),o.jsx(C,{label:"Connected agents",name:"agents",mode:"multiple",options:t.options,fieldProps:{maxTagCount:1,loading:t.loading}})]})},V=()=>{const{modal:a,message:s}=y.useApp(),i=j.useRef(null),n=m(()=>{var t;(t=i.current)==null||t.reload()}),r=m(t=>{a.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify"},onOk:async()=>{try{await b({coordinationUuid:t.coordinationUuid}),n(),s.success("Deletion successful.")}catch(e){return s.error("Deletion failed."),Promise.reject(e)}}})});return o.jsx(A,{className:"shopify",title:"Coordinations",extra:o.jsx(p,{width:620,destroyOnHidden:!0,className:"shopify",title:"Add Coordination",trigger:o.jsx(F,{className:"shopify",type:"primary",children:"Add coordination"}),children:o.jsx(x,{onSuccess:n})}),children:o.jsx(D,{actionRef:i,className:"shopify",options:!1,size:"small",search:!1,pagination:{defaultPageSize:4},rowKey:"coordinationUuid",scroll:{x:"max-content"},columns:[{title:"Coordination UUID",dataIndex:"coordinationUuid"},{title:"Coordination Name",dataIndex:"coordinationName"},{title:"Create at",dataIndex:"createAt",render:(t,e)=>g(e.createAt)},{title:"Update at",dataIndex:"updateAt",render:(t,e)=>g(e.updateAt)},{width:100,title:"Actions",key:"action",fixed:"right",render:(t,e)=>o.jsxs(N,{children:[o.jsx(p,{width:620,destroyOnHidden:!0,className:"shopify",title:"Edit Coordination",trigger:o.jsx(f,{icon:P}),children:o.jsx(x,{formData:e,onSuccess:n})}),o.jsx(f,{icon:w,onClick:()=>r(e)})]})}],request:async t=>{const{coordinationList:e}=await _({limit:t.pageSize,pageNumber:t.current});return{total:e.total,data:e.coordinationList}}})})};export{V as default};
