import{y as h,A as T,f as m,b as C,j as e,W as s,K as f,n as y,o as d,w,x as E,P as I,S as D,D as P,L as B,B as N}from"./libs-BaOSQqCJ.js";import{f as j}from"./index-BO1sSPnO.js";import{T as b}from"./index-CBVePskl.js";import{I as g}from"./index-CjwgjA-6.js";import{W as S}from"./map-BPCwAIgA.js";import{b as F,u as q}from"./hooks-BBYTyBeI.js";import{f as v,h as U,e as k}from"./wizard-VA_QYG2R.js";import"./index-s4o2-lRw.js";import"./enum-Ct7sVdAK.js";import"./generate-DRufkOf2.js";const L=a=>{if(!a)return;const{elements:n,...l}=a;return{...l}},M=a=>({...a,updatedBy:"Admin"}),A=a=>{const{formData:n}=a,[l]=h.useForm(),{message:i}=T.useApp(),[o]=F(),c=m(()=>{l.setFieldsValue(L(n))});return C.useEffect(()=>{n&&c()},[n]),q(async()=>{var u;const r=await l.validateFields(),t=M(r);try{await v(t),o(),(u=a.onSuccess)==null||u.call(a),i.success(`Element ${n?"updated":"created"} successfully.`)}catch{i.error(`Failed to ${n?"update":"create"} Element.`)}}),e.jsxs(h,{form:l,submitter:!1,style:{padding:"24px 0 0 0"},children:[e.jsx(s,{hidden:!0,name:"elementUuid"}),e.jsx(s,{label:"Element Title",name:"elementTitle",rules:[{required:!0}]}),e.jsx(s,{label:"Data Type",name:"dataType",rules:[{required:!0}]}),e.jsx(s,{label:"Attribute Name",name:"attributeName",rules:[{required:!0}]}),e.jsx(s,{label:"Attribute Type",name:"attributeType",rules:[{required:!0}]}),e.jsx(s,{label:"Priority",name:"priority",rules:[{required:!0}]}),e.jsx(f,{label:"Option Values",name:"optionValues",creatorButtonProps:{creatorButtonText:"Add Option"},children:e.jsxs(y,{gutter:16,children:[e.jsx(d,{span:12,children:e.jsx(s,{name:"name",label:"Name",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})}),e.jsx(d,{span:12,children:e.jsx(s,{name:"value",label:"Value",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})})]})}),e.jsx(f,{label:"Conditions",name:"conditions",creatorButtonProps:{creatorButtonText:"Add Condition"},children:e.jsxs(y,{gutter:16,children:[e.jsx(d,{span:12,children:e.jsx(s,{name:"attribute",label:"Attribute",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})}),e.jsx(d,{span:12,children:e.jsx(s,{name:"value",label:"Value",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})})]})})]})},J=()=>{const{modal:a,message:n}=T.useApp(),l=w(),i=C.useRef(null),o=m(()=>{var r;(r=i.current)==null||r.reload()}),c=m(r=>{a.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify gray"},onOk:async()=>{try{await U({elementUuid:r.elementUuid}),o(),n.success("Deletion successful.")}catch(t){return n.error("Deletion failed."),Promise.reject(t)}}})});return e.jsx(E,{title:"UI Blocks / Elements",onBack:()=>l(-1),extra:e.jsx(b,{width:600,className:"shopify",title:"Create new element",trigger:e.jsx(N,{className:"shopify",type:"primary",children:"Create new element"}),children:e.jsx(A,{})}),children:e.jsx(I,{actionRef:i,search:!1,options:!1,scroll:{x:"max-content"},rowKey:"elementUuid",className:"shopify",request:async r=>{const{current:t,pageSize:u,...p}=r,{elementList:x}=await k({limit:u,pageNumber:t,...p});return{total:x.total,data:x.elementList}},columns:[{title:"Element Name",dataIndex:"elementTitle"},{title:"Element UUID",dataIndex:"elementUuid",hideInSearch:!0},{title:"Data Type",dataIndex:"dataType",valueEnum:S},{hideInSearch:!0,title:"Priority",dataIndex:"priority"},{title:"Create at",dataIndex:"createdAt",hideInSearch:!0,render:(r,t)=>j(t.createdAt)},{title:"Last updated",dataIndex:"updatedAt",hideInSearch:!0,render:(r,t)=>j(t.updatedAt)},{width:"120px",key:"action",title:"Action",align:"center",fixed:"right",hideInSearch:!0,render:(r,t)=>e.jsxs(D,{children:[e.jsx(b,{width:600,destroyOnHidden:!0,className:"shopify",title:"Element Details",trigger:e.jsx(g,{icon:P}),children:e.jsx(A,{formData:t,onSuccess:o})}),e.jsx(g,{icon:B,onClick:()=>c(t)})]})}]})})};export{J as default};
