import{v as E,f as n,b as r,ay as b,h as F,j as t,M as R,ao as B,s as z}from"./libs-BF3diSH3.js";import{T as I}from"./index-C5iRsA-N.js";import{S as v}from"./index-BCRILwkD.js";const U=l=>{const[e,s]=E(!1),o=n(()=>s(!0)),p=n(f=>{var c,i;o(),(i=(c=l.props).onClick)==null||i.call(c,f)}),u=n(()=>{s(!1)}),d=r.cloneElement(l,{onClick:p});return{open:e,onOpen:o,onClose:u,trigger:d}},G=l=>{const{modal:e,onOpen:s,onClose:o,trigger:p,className:u,rootClassName:d,okText:f="Save",hasFooter:c=!0,cancelText:i="Back",showCancel:T=!0,...g}=l,[m,M]=E(!1),{open:h,onClose:x,onOpen:N,trigger:S}=U(p),w=r.useMemo(()=>m?{...g,closable:!1}:g,[g,m]),k=r.useMemo(()=>new b,[]),y=n((a,C)=>k.listeners(a).map(P=>P(C))),O=n(async a=>{M(!0);try{await Promise.all(y("ok",a))}catch(C){console.error(C)}M(!1)}),j=n(async a=>{m||(await Promise.all(y("cancel",a)),x())});return r.useEffect(()=>{e&&(e.closeModal=x,e.openModal=N)},[e]),F(()=>{h?s==null||s():o==null||o()},[h]),t.jsxs(I.Provider,{value:{event:k,closeModal:x},children:[S,t.jsx(R,{...w,open:h,onCancel:j,rootClassName:B("shopify",d),className:u,footer:c?t.jsxs(r.Fragment,{children:[t.jsx(v,{type:"text",children:i,onClick:j,icon:t.jsx(z,{}),className:!T||m?"visb-hide":""}),t.jsx(v,{type:"primary",children:f,onClick:O})]}):null})]})};export{G as T,U as u};
