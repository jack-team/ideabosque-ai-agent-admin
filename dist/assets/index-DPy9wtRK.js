import{m as E,u as t,b as n,ak as F,ap as B,aq as U,x as q,j as r,M as z,af as I,k as L}from"./libs-0PvTe91r.js";import{T}from"./index-Bl_Q_f31.js";import{S as y}from"./index-CendYzG9.js";const A=e=>{const[s,o]=E(!1),a=t(()=>o(!0)),d=t(p=>{var c,u;a(),(u=(c=e.props).onClick)==null||u.call(c,p)}),f=t(()=>{o(!1)}),m=n.cloneElement(e,{onClick:d});return{open:s,onOpen:a,onClose:f,trigger:m}},N=()=>n.useContext(T),J=()=>[n.useRef({closeModal:()=>null,openModal:()=>null}).current],K=e=>{const{event:s}=N(),o=t(e);F(()=>s.on("ok",o)),B(()=>s.off("ok",o))},Q=()=>{const{closeModal:e}=N();return[e]},V=e=>{const{modal:s,onOpen:o,onClose:a,trigger:d,className:f,rootClassName:m,okText:p="Save",hasFooter:c=!0,cancelText:u="Back",showCancel:O=!0,...M}=e,[i,C]=E(!1),{open:x,onClose:g,onOpen:S,trigger:b}=A(d),w=n.useMemo(()=>i?{...M,closable:!1}:M,[M,i]),h=n.useMemo(()=>new U,[]),j=t((l,k)=>h.listeners(l).map(R=>R(k))),P=t(async l=>{C(!0);try{await Promise.all(j("ok",l))}catch(k){console.error(k)}C(!1)}),v=t(async l=>{i||(await Promise.all(j("cancel",l)),g())});return n.useEffect(()=>{s&&(s.closeModal=g,s.openModal=S)},[s]),q(()=>{x?o==null||o():a==null||a()},[x]),r.jsxs(T.Provider,{value:{event:h,closeModal:g},children:[b,r.jsx(z,{...w,open:x,onCancel:v,rootClassName:I("shopify",m),className:f,footer:c?r.jsxs(n.Fragment,{children:[r.jsx(y,{type:"text",children:u,onClick:v,icon:r.jsx(L,{}),className:!O||i?"visb-hide":""}),r.jsx(y,{type:"primary",children:p,onClick:P})]}):null})]})};export{V as T,J as a,Q as b,A as c,K as u};
