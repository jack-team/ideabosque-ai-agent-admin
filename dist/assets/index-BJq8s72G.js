import{v as x,A as G,e as m,b,j as e,W as u,F as A,w as C,G as Q,l as w,m as y,t as D,P as F,S as N,B as d}from"./libs-CZ9azTWP.js";import{b as h}from"./index-1JQ8SzD-.js";import{T as g}from"./index-LqR22ykg.js";import{f as q}from"./index-BO-i8_LU.js";import{b as P,u as v}from"./hooks-CVF4ayDs.js";import{a as f}from"./generate-y9PIVPyp.js";import{R as M}from"./map-BJxYnWC7.js";import"./index-CoeBZIRU.js";import"./enum-Ct7sVdAK.js";const S=r=>{if(!r)return;let{questionCriteria:t,...i}=r;const o={...t};return{...i,questionCriteria:Object.keys(o).map(n=>({attribute:n,value:o[n]}))}},U=r=>{const{questionCriteria:t,...i}=r,n=t.reduce((a,s)=>({...a,[s.attribute]:s.value}),{});return{...i,questionCriteria:n,updatedBy:"Admin"}},k=async r=>{const t=await f({type:"Query",name:"questionGroupList"});return h.graphql({query:t,variables:r})},I=async r=>{const t=await f({type:"Mutation",name:"insertUpdateQuestionGroup"});return h.graphql({query:t,variables:r})},R=async r=>{const t=await f({type:"Mutation",name:"deleteQuestionGroup"});return h.graphql({query:t,variables:r})},j=r=>{const{formData:t}=r,[i]=x.useForm(),{message:o}=G.useApp(),[n]=P(),a=m(()=>{i.setFieldsValue(S(t))});return b.useEffect(()=>{t&&a()},[t]),v(async()=>{var l;const s=await i.validateFields(),c=U(s);try{await I(c),n(),(l=r.onSuccess)==null||l.call(r),o.success(`Question Group ${t?"updated":"created"} successfully.`)}catch{o.error(`Failed to ${t?"updated":"created"} Question Group.`)}}),e.jsxs(x,{form:i,submitter:!1,layout:"horizontal",labelAlign:"left",labelCol:{flex:"220px"},style:{padding:"24px 0 0 0"},children:[e.jsx(u,{hidden:!0,name:"questionGroupUuid"}),e.jsx(u,{label:"Question Group Name",name:"questionGroupName",rules:[{required:!0}]}),e.jsx(A,{label:"Question Group Description",name:"questionGroupDescription",rules:[{required:!0}]}),e.jsx(u,{label:"Weight",name:"weight",rules:[{required:!0}]}),e.jsx(C,{label:"Region",name:"region",valueEnum:M,rules:[{required:!0}]}),e.jsx(Q,{label:"Question Criteria",name:"questionCriteria",children:e.jsxs(w,{gutter:16,children:[e.jsx(y,{span:12,children:e.jsx(u,{label:"Attribute",name:"attribute",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})}),e.jsx(y,{span:12,children:e.jsx(u,{label:"Value",name:"value",labelCol:{span:24},wrapperCol:{span:24},rules:[{required:!0}]})})]})})]})},$=()=>{const{modal:r,message:t}=G.useApp(),i=b.useRef(null),o=m(()=>{var a;(a=i.current)==null||a.reload()}),n=m(a=>{r.confirm({title:"Are you sure you want to delete?",okText:"Delete",okButtonProps:{danger:!0,className:"shopify"},cancelButtonProps:{className:"shopify"},onOk:async()=>{try{await R({questionGroupUuid:a.questionGroupUuid}),o(),t.success("Deletion successful.")}catch(s){return t.success("Deletion failed."),Promise.reject(s)}}})});return e.jsx(D,{title:"Question Groups",extra:e.jsx(g,{width:600,className:"shopify",title:"Create Question Group",trigger:e.jsx(d,{className:"shopify",type:"primary",children:"Create Question group"}),children:e.jsx(j,{onSuccess:o})}),children:e.jsx(F,{actionRef:i,search:!1,options:!1,rowKey:"questionGroupUuid",className:"shopify",request:async a=>{const{current:s,pageSize:c,...l}=a,{questionGroupList:p}=await k({limit:c,pageNumber:s,...l});return{total:p.total,data:p.questionGroupList}},columns:[{title:"Question Group UUID",dataIndex:"questionGroupUuid"},{title:"Question Group Name",dataIndex:"questionGroupName"},{title:"Create at",dataIndex:"createdAt",hideInSearch:!0,render:(a,s)=>q(s.createdAt)},{title:"Update at",dataIndex:"updatedAt",hideInSearch:!0,render:(a,s)=>q(s.updatedAt)},{width:"120px",key:"action",title:"Action",align:"center",hideInSearch:!0,render:(a,s)=>e.jsxs(N,{children:[e.jsx(g,{width:600,destroyOnHidden:!0,className:"shopify",title:"Edit Question Groups",trigger:e.jsx(d,{size:"small",type:"primary",className:"shopify",children:"Edit"}),children:e.jsx(j,{formData:s,onSuccess:o})}),e.jsx(d,{danger:!0,size:"small",className:"shopify",onClick:()=>n(s),children:"Delete"})]})}]})})};export{$ as default};
