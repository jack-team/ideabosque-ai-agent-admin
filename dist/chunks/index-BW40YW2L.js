import{J as j,D as n,r as a,E as F,k as t}from"./vendor-BASRo5BV.js";import{M as R,G as b,d as B}from"./ui-CrIkMfD8.js";import{E as z,T as D}from"../assets/index-BYkTdspT.js";import{S as T}from"./index-CV5W7j9Q.js";const G=l=>{const[e,s]=j(!1),o=n(()=>s(!0)),p=n(f=>{var c,i;o(),(i=(c=l.props).onClick)==null||i.call(c,f)}),u=n(()=>{s(!1)}),d=a.cloneElement(l,{onClick:p});return{open:e,onOpen:o,onClose:u,trigger:d}},A=l=>{const{modal:e,onOpen:s,onClose:o,trigger:p,className:u,rootClassName:d,okText:f="Save",hasFooter:c=!0,cancelText:i="Back",showCancel:v=!0,...g}=l,[m,k]=j(!1),{open:x,onClose:h,onOpen:N,trigger:S}=G(p),w=a.useMemo(()=>m?{...g,closable:!1}:g,[g,m]),M=a.useMemo(()=>new z,[]),E=n((r,C)=>M.listeners(r).map(P=>P(C))),O=n(async r=>{k(!0);try{await Promise.all(E("ok",r))}catch(C){console.error(C)}k(!1)}),y=n(async r=>{m||(await Promise.all(E("cancel",r)),h())});return a.useEffect(()=>{e&&(e.closeModal=h,e.openModal=N)},[e]),F(()=>{x?s==null||s():o==null||o()},[x]),t.jsxs(D.Provider,{value:{event:M,closeModal:h},children:[S,t.jsx(R,{...w,open:x,onCancel:y,rootClassName:b("shopify",d),className:u,footer:c?t.jsxs(a.Fragment,{children:[t.jsx(T,{type:"text",children:i,onClick:y,icon:t.jsx(B,{}),className:!v||m?"visb-hide":""}),t.jsx(T,{type:"primary",children:f,onClick:O})]}):null})]})};export{A as T,G as u};
